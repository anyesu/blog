### å‰è¨€

---

å‰å‡ å¤©å®¶äººè¯´åŠå…¬å®¤çš„ç”µè„‘ [â€œä¸­ç—…æ¯’â€](https://www.zhihu.com/question/60106557/answer/571650593) äº†ï¼Œ **QQ è¿œç¨‹** ä¸€çœ‹æœç„¶æ˜¯ä¸­äº†æµæ°“è½¯ä»¶çš„æ‹›ï¼š

- **æ»¡å±çš„å¹¿å‘Šå¼¹çª—**
- **æ¡Œé¢å„ç§æ‚¬æµ®çª—**
- **å½¢å½¢è‰²è‰²çš„æµè§ˆå™¨å›¾æ ‡**
- **ç–¯ç‹‚é—ªçƒçš„ä»»åŠ¡æ **
- **â€¦â€¦**

![cover](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/cover.png)

è¿˜å¥½ä¸æ˜¯çœŸçš„ä¸­äº†ç ´åæ€§çš„ç—…æ¯’ï¼Œåªæ˜¯æ¶å¿ƒäº†ç‚¹ï¼ŒèŠ±äº† **2** ä¸ªå°æ—¶æ¸…ç†å¹²å‡€äº†ã€‚

è¶ç€è‡ªå·±åˆš [é‡è£…](https://anyesu.github.io/blog/articles/38) å®Œç³»ç»Ÿï¼Œé¡ºä¾¿è¡¥ä¸€ä¸ªæ‰‹åŠ¨æ¸…ç†çš„ç¬”è®°ã€‚

### å‚»ç“œå¼å¤„ç†æ–¹æ³•

---

- ç›´æ¥å¸è½½æ‰€æœ‰èƒ½å¸è½½çš„æµæ°“è½¯ä»¶ã€‚

- ç”¨ **SoftCnKiller** ï¼ˆ ä¸‹æ–‡å·¥å…·ä¸­ ï¼‰ä¸€é”®å¤„ç†ã€‚

  ![åˆ©ç”¨ SoftCnKiller å¤„ç†](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/softcnkiller.png)

- ç¢°åˆ° **é¡½å›ºåˆ†å­** å†å›æœ¬æ–‡æ‰¾å¯¹ç­–ã€‚ğŸ˜œ

### å·¥å…·æ±‡æ€»

---

è¿™é‡Œå…ˆç½—åˆ—ä¸€äº›å¯èƒ½æœ‰å¸®åŠ©çš„å·¥å…·ï¼Œåé¢ä¼šä»‹ç»è„±ç¦»è¿™äº›å·¥å…·çš„æ“ä½œæ–¹æ³•ã€‚

| åç§°                                                                                              | è¯´æ˜                                                                                                                                                                                                                                                                                                               |
| ------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| [Sysinternals å¥—ä»¶](https://docs.microsoft.com/sysinternals/downloads/sysinternals-suite)         | å¾®è½¯è‡ªå®¶ï¼ˆ æ”¶è´­çš„ ï¼‰çš„ç³»ç»Ÿç®¡ç†å·¥å…·åŒ…ï¼ŒåŒ…å«å•ç‹¬çš„æ•…éšœæ’é™¤å®ç”¨å·¥å…·å’Œå¸®åŠ©æ–‡ä»¶ã€‚ä¸‹æ–‡æåˆ°çš„ [Autoruns](https://docs.microsoft.com/sysinternals/downloads/autoruns) ã€ [Process Explorer](https://docs.microsoft.com/sysinternals/downloads/process-explorer) å°±åŒ…å«åœ¨å…¶ä¸­ï¼Œä¹Ÿå¯ä»¥é€‰å–éœ€è¦çš„å·¥å…·å•ç‹¬ä¸‹è½½ã€‚               |
| [Registry Workshop](http://www.torchsoft.com/en/download.html)                                    | æ³¨å†Œè¡¨å·¥å…·ï¼Œæ¯”ç³»ç»Ÿè‡ªå¸¦çš„ [regedit](https://www.file.net/process/regedit.exe.html) å¼ºå¤ªå¤šäº†ã€‚                                                                                                                                                                                                                       |
| [PowerShell](https://docs.microsoft.com/zh-cn/powershell/scripting/install/installing-powershell) | **PowerShell** æ˜¯ä¸€ç§è·¨å¹³å°çš„ä»»åŠ¡è‡ªåŠ¨åŒ–è§£å†³æ–¹æ¡ˆï¼Œç”±å‘½ä»¤è¡Œ **shell** ã€è„šæœ¬è¯­è¨€å’Œé…ç½®ç®¡ç†æ¡†æ¶ç»„æˆã€‚ **PowerShell** å¯åœ¨ **Windows** ã€ **Linux** å’Œ **macOS** ä¸Šè¿è¡Œã€‚                                                                                                                                              |
| [Everything](https://www.voidtools.com)                                                           | ç›®å‰ **Windows** ä¸Šæœ€å¼ºçš„æ–‡ä»¶æœç´¢å¼•æ“ï¼Œæ²¡æœ‰ä¹‹ä¸€ã€‚                                                                                                                                                                                                                                                                  |
| [FILExt](https://filext.com)                                                                      | åœ¨çº¿æ–‡ä»¶åˆ†æï¼Œç”¨äºæå–æ–‡ä»¶ï¼ˆ ç‰¹åˆ«æ˜¯ç—…æ¯’ ï¼‰çš„ä¿¡æ¯å’Œå†…å®¹ã€‚                                                                                                                                                                                                                                                           |
| [ContextMenuManager](https://github.com/BluePointLilac/ContextMenuManager)                        | çº¯ç²¹çš„ **Windows** å³é”®èœå•ç®¡ç†ç¨‹åºã€‚                                                                                                                                                                                                                                                                              |
| [è½¯åª’é­”æ–¹](https://mofang.ruanmei.com)                                                            | è€ç‰Œå›½äº§ **Windows** ä¼˜åŒ–å·¥å…·ï¼Œä¸æ‰§è¡Œä¸»ç¨‹åºï¼ˆ `pcmaster.exe` ï¼‰å°±æ˜¯ç»¿è‰²ä¾¿æºç‰ˆè½¯ä»¶ã€‚                                                                                                                                                                                                                                |
| [å¾® PE](http://www.wepe.com.cn)                                                                   | æ¨èçš„ [PE](https://docs.microsoft.com/windows-hardware/manufacture/desktop/winpe-intro) ç³»ç»Ÿã€‚                                                                                                                                                                                                                    |
| [SoftCnKiller](https://blog.csdn.net/hfhbutn/article/details/104799162)                           | æ˜¯ä¸€æ¬¾ä¸“é—¨é’ˆå¯¹å›½äº§æµæ°“è½¯ä»¶çš„æ¸…ç†å·¥å…·ï¼ˆ [æ“ä½œè§†é¢‘](https://www.bilibili.com/video/av674434089) ï¼‰ï¼ŒåŸºäºæ•°å­—ç­¾åå’Œè·¯å¾„æœç´¢ï¼Œæ”¯æŒæ›´æ–° [é»‘åå•é…ç½®](https://gitee.com/softcnkiller/data) ã€‚å›¾çœäº‹çš„è¯å¯ä»¥ç”¨å®ƒä¸€é”®å¤„ç†ï¼Œä¸è¿‡æˆ‘è¿˜æ˜¯å»ºè®®ç”¨å®ƒæ¥æ‰«æé—®é¢˜è€Œä¸æ˜¯ç›´æ¥å¤„ç†ã€‚é™„å¸¦çš„ **adwView** æ”¯æŒçª—å£æ•æ‰ã€ä»»åŠ¡æ åŠæ‰˜ç›˜æŸ¥è¯¢ã€‚ |
| [Total Uninstall](https://www.martau.com)                                                         | è½¯ä»¶å¸è½½å·¥å…·ï¼Œä¸‹æ–‡æœ‰ä»‹ç»ã€‚                                                                                                                                                                                                                                                                                         |
| [ç«ç»’](https://www.huorong.cn)                                                                    | åˆ°å¤„è¢«å®‰åˆ©çš„ä¸­å›½ç‰¹è‰²æ€æ¯’è½¯ä»¶ï¼Œç•Œé¢ç®€æ´ï¼Œä¸»æ‰“å›½äº§æµæ°“è½¯ä»¶æŸ¥æ€ï¼ˆ åˆšå®‰è£…å®Œå°±æŠŠ **é²¸å½©å£çº¸** å½“ç—…æ¯’æ€æ‰äº† ï¼‰å’Œå¹¿å‘Šå¼¹çª—æ‹¦æˆªã€‚è‡³äºå…¶ç‰¹è‰²çš„ **ç«ç»’å‰‘** åŠå…¶ä»–ç›¸å…³å·¥å…·æˆ‘å¯¹æ¯” **è¯•ç”¨** åå‘ç°å°±æ˜¯ä¸­æ–‡ç‰ˆçš„ **Sysinternals å¥—ä»¶** ã€‚                                                                                          |

#### **PowerShell** å…¬å…±å‡½æ•°

æ³¨å†Œè¡¨çš„æ“ä½œè¿˜æ˜¯è¿‡äºç¹çï¼Œå°è£…äº†å‡ ä¸ªå‡½æ•°ï¼Œä¹‹åçš„ **PowerShell** è„šæœ¬åœ¨æ‰§è¡Œå‰éœ€è¦åœ¨æ–°çª—å£æ·»åŠ ä¾èµ–ï¼š

```powershell
function Format-RegistryPath([String[]] $Path) {
    for ($i = 0; $i -lt $Path.Length; ++$i) {
        $Path[$i] = "Registry::$($Path[$i])"
    }
    $Path
}

function Get-RegistryChildItem([String[]] $Path) {
    ls -LiteralPath (Format-RegistryPath $Path) -ErrorAction Ignore
}

function Get-RegistryValue([String[]] $Path, [String] $Name) {
    (gp -LiteralPath (Format-RegistryPath $Path) -Name $Name -ErrorAction Ignore).$Name
}

function Get-RegistryDefault([String[]] $Path) {
    Get-RegistryValue $Path '(default)'
}

function Get-RegistryRefDll([String] $GUID) {
    Get-RegistryDefault "HKCR\CLSID\$($GUID)\InprocServer32"
}

function Get-RegistryProperties([String[]] $Path) {
    $col1 = @{l="Key";e={$Key}}
    $col2 = @{l="Name";e={$_}}
    $col3 = @{l="Data";e={Get-RegistryValue $Key $_}}
    gi -LiteralPath (Format-RegistryPath $Path) -ErrorAction Ignore | % {
        $Key = $_.Name
        $_ | select -ExpandProperty Property |
            select $col1, $col2, $col3
    }
}
```

ç”±äºæ‰¹å¤„ç†æŸ¥è¯¢æ³¨å†Œè¡¨å¾ˆæ…¢ä¹Ÿå¾ˆéº»çƒ¦ï¼Œæ‰€ä»¥æœ¬æ–‡ä»¥ **PowerShell** è„šæœ¬ä¸ºä¸»ï¼Œæ—§ç‰ˆç³»ç»Ÿå¯èƒ½ [ä¸æ”¯æŒ](https://docs.microsoft.com/zh-cn/powershell/scripting/windows-powershell/install/installing-windows-powershell#upgrading-existing-windows-powershell) è€Œéœ€è¦å•ç‹¬å®‰è£… **PowerShell** ã€‚

#### æ³¨å†Œ/åæ³¨å†Œ DLL

```powershell
:: æ³¨å†Œ DLL
regsvr32 xxx.dll
:: åæ³¨å†Œ DLL
regsvr32 /u xxx.dll
```

å°†ä¸‹é¢çš„å†…å®¹ä¿å­˜åˆ° **å³é”®èœå•-(å)æ³¨å†Œ DLL.reg** æ–‡ä»¶ä¸­ï¼ˆ å¦å­˜ä¸º **ANSI ç¼–ç ** ï¼‰ï¼ŒåŒå‡»å¯¼å…¥åˆ°æ³¨å†Œè¡¨åå°±èƒ½å³é”® **DLL** æ–‡ä»¶è¿›è¡Œ **æ³¨å†Œ/åæ³¨å†Œ** ã€‚è½¯åª’è®¾ç½®å¤§å¸ˆé›†æˆäº†è¿™ä¸ªèœå•é¡¹ï¼Œä½†ç”±äºæ²¡æœ‰è·å–ç®¡ç†å‘˜æƒé™æ‰€ä»¥ä¼šæ‰§è¡Œå¤±è´¥ã€‚

```ini
Windows Registry Editor Version 5.00

[HKEY_CLASSES_ROOT\dllfile\shell]

[HKEY_CLASSES_ROOT\dllfile\shell\Reg]
@="æ³¨å†Œ DLL"
"HasLUAShield"=""

[HKEY_CLASSES_ROOT\dllfile\shell\Reg\Command]
@="powershell -WindowStyle Hidden -Command \"Start-Process 'regsvr32' '\\\"%1\\\"' -Verb RunAs\""

[HKEY_CLASSES_ROOT\dllfile\shell\UnReg]
@="åæ³¨å†Œ DLL"
"HasLUAShield"=""

[HKEY_CLASSES_ROOT\dllfile\shell\UnReg\Command]
@="powershell -WindowStyle Hidden -Command \"Start-Process 'regsvr32' '/u \\\"%1\\\"' -Verb RunAs\""
```

### æµæ°“è½¯ä»¶ FAQ

---

#### æ˜æ˜æ²¡æœ‰å®‰è£…è¿™ä¸ªè½¯ä»¶ï¼Œä¸ºä»€ä¹ˆä¼šæœ‰ï¼Ÿ

ä¸€èˆ¬ä¸‹è½½ç«™çš„ **é«˜é€Ÿä¸‹è½½å™¨** æˆ–è€…æŸäº›å®‰è£…ç¨‹åºä¼šé»˜è®¤å‹¾é€‰æ†ç»‘ä¸‹è½½å…¶ä»–è½¯ä»¶ï¼Œä¸ç•™ç¥ç›´æ¥ç‚¹ä¸‹ä¸€æ­¥å°±ä¼šä¸­æ‹›ï¼ˆ ç°åœ¨å¯èƒ½è¿é€‰æ‹©çš„æœºä¼šéƒ½æ²¡æœ‰äº† ï¼‰ã€‚

é™¤æ­¤ä¹‹å¤–ï¼Œæµæ°“è½¯ä»¶ä¼šæœ‰ä¸€ä¸ªè½¯ä»¶è”ç›Ÿï¼Œå®‰è£…äº† **A** ä¹‹åï¼Œ **A** ä¼šåœ¨åå°å·å·å®‰è£… **B** ï¼Œ **B** å¯èƒ½è¿˜ä¼šåè¿‡æ¥æ£€æµ‹ **A** æ˜¯å¦å·²å®‰è£…ï¼ˆ æœªå®‰è£…å°±å»ä¸‹è½½ ï¼‰ï¼Œè¿™æ ·å°±å½¢æˆäº†ä¸€ç§ä¿æ´»æœºåˆ¶ã€‚

#### å¦‚ä½•å…³é—­ä¸€ä¸ªè½¯ä»¶æˆ–å¹¿å‘Šï¼Ÿ

æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨æ‰¾åˆ°å¯¹åº”çš„è¿›ç¨‹ç»“æŸæ‰å³å¯ã€‚æœ‰äº›è¿›ç¨‹å¯èƒ½ä¼šæ¨¡ä»¿æˆç³»ç»Ÿè¿›ç¨‹çš„æ ·å­ï¼ˆ åå­— ï¼‰æˆ–è€…æ‰æ ¹åˆ°ç³»ç»Ÿç›®å½•ä»¤äººéš¾ä»¥åˆ†è¾¨ï¼Œåˆ†è¾¨ä¸å‡ºæ¥å¯ä»¥è€ƒè™‘ç»“æŸæ‰æ­£åœ¨è¿è¡Œçš„å…¶ä»–è½¯ä»¶åé‡å¯ç”µè„‘ã€‚

> ä»»åŠ¡ç®¡ç†å™¨ > è¯¦ç»†ä¿¡æ¯ > å³é”®æ ‡é¢˜æ  > é€‰æ‹©åˆ— > å‹¾é€‰å‘½ä»¤è¡Œ > æŒ‰å‘½ä»¤è¡Œæ’åº
>
> å³é”®è¿›ç¨‹å¯æ‰“å¼€æ–‡ä»¶æ‰€åœ¨çš„ä½ç½®ï¼Œçœ‹çœ‹æ˜¯å¦å¯ä»¥åˆ é™¤ã€‚æœ‰äº›è¿›ç¨‹æ˜¯é€šè¿‡ **svchost.exe** æ‰“å¼€çš„ï¼Œå…·æœ‰è¿·æƒ‘æ€§ï¼Œè¯¦è§ä¸‹æ–‡ã€‚

å¯ä»¥å€ŸåŠ©å¾®è½¯å®¶çš„ **Process Explorer** å·¥å…·æŸ¥è¯¢ï¼Œå®ƒå¯ä»¥ä½œä¸ºä»»åŠ¡ç®¡ç†å™¨çš„åŠ å¼ºç‰ˆæ¥ä½¿ç”¨ï¼š

- æ•æ‰çª—å£æ‰€å±çš„è¿›ç¨‹ã€‚
- æ˜¾ç¤ºè¿›ç¨‹çš„çˆ¶å­å…³ç³»ï¼ˆ å¯èƒ½ä¸å¤ªå‡† ï¼‰ã€‚
- æ ¹æ®å…¬å¸åç§°èƒ½å¿«é€Ÿåˆ†è¾¨å‡ºå“ªäº›æ˜¯ç¬¬ä¸‰æ–¹è¿›ç¨‹ã€‚
- æŸ¥çœ‹æ¯ä¸ªè¿›ç¨‹æ‰€åŠ è½½çš„ **DLL** ã€‚
- æŸ¥è¯¢å ç”¨ **DLL** çš„è¿›ç¨‹ã€‚
- æŸ¥çœ‹è¿›ç¨‹å¼€æœºå¯åŠ¨çš„åŸå› ã€‚

#### è½¯ä»¶å…³æ‰åä¸ºä»€ä¹ˆä¼šåˆè‡ªåŠ¨è¿è¡Œäº†ï¼Ÿ

- æ‰‹åŠ¨ç»“æŸååˆè‡ªåŠ¨æ‰“å¼€äº†ï¼Œè¯´æ˜è¿˜æœ‰ä¸€ä¸ªè¿›ç¨‹åœ¨æ§åˆ¶ç€å®ƒã€‚æ¯”å¦‚ä»¥å‰å¾ˆå¥½ç”¨çš„ **2345 çœ‹å›¾ç‹** æ€»æ˜¯ä¼šå¼¹å¹¿å‘Šï¼Œå¹¿å‘Šæ€ä¹ˆå…³éƒ½å…³ä¸æ‰ï¼Œæ ¹æœ¬è§£å†³åŠæ³•å°±æ˜¯å¸è½½æ‰ **2345 çœ‹å›¾ç‹** ï¼Œæ‰¾å…¶ä»–è½¯ä»¶ä»£æ›¿å®ƒã€‚
- é‡å¯ååˆè‡ªåŠ¨æ‰“å¼€ï¼Œè¯´æ˜è¿™ä¸ªè½¯ä»¶æˆ–è€…è¯´å®ƒçš„æ¯ä½“æ˜¯å¼€æœºå¯åŠ¨çš„ï¼Œéœ€è¦ç¦æ­¢æˆ–è€…åˆ æ‰å¯¹åº”çš„å¼€æœºå¯åŠ¨é¡¹ã€‚

#### è½¯ä»¶æ˜¯å¦‚ä½•å¼€æœºå¯åŠ¨ï¼Ÿ

![Autoruns](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/autoruns.png)

å¯ä»¥å€ŸåŠ©å¾®è½¯å®¶çš„ **Autoruns** å·¥å…·æŸ¥è¯¢ï¼ˆ é€‰é¡¹ - éšè—å¾®è½¯çš„é¡¹ç›® ï¼‰ï¼ŒåŸºäºæ³¨å†Œè¡¨æŸ¥è¯¢æ‰€æœ‰è‡ªåŠ¨è¿è¡Œçš„é¡¹ç›®ã€‚å¸¸è§çš„æœ‰ä¸‹é¢å‡ ç§æ–¹æ³•ï¼š

##### å°†å¿«æ·æ–¹å¼å¤åˆ¶åˆ°å¼€å§‹èœå•çš„å¯åŠ¨é¡¹ä¸­

> `win + R` > `shell:startup`

æœ€æ–¹ä¾¿çš„å¼€æœºå¯åŠ¨æ–¹å¼ï¼Œé€‚åˆæ™®é€šç”¨æˆ·ã€‚

> [!IMPORTANT]
>
> éœ€è¦ **ç®¡ç†å‘˜æƒé™** è¿è¡Œçš„ç¨‹åºæ”¾è¿™é‡Œæ˜¯æ— æ³•å¼€æœºå¯åŠ¨çš„ã€‚

##### è®¡åˆ’ä»»åŠ¡ä¸­æ·»åŠ ä»»åŠ¡

æ”¯æŒæ›´é«˜çº§çš„å¼€æœºå¯åŠ¨é…ç½®ï¼Œæœ¬è´¨ä¸Šè¿˜æ˜¯ç”±ä¸€ä¸ª **è®¡åˆ’ä»»åŠ¡** çš„æœåŠ¡è°ƒåº¦çš„ï¼Œä¼šæœ‰å»¶è¿Ÿã€‚

å‚è€ƒã€Š [Windows 10 å†…ç½® Linux å­ç³»ç»Ÿåˆä½“éªŒ](https://anyesu.github.io/blog/articles/8) ã€‹ä¸­ **WSL å¼€æœºå¯åŠ¨** å°èŠ‚å†…å®¹ã€‚

##### [æ³¨å†Œä¸º Windows æœåŠ¡](https://zhuanlan.zhihu.com/p/93808282)

æ›´å¤šæœåŠ¡ç›¸å…³å†…å®¹å‚è€ƒã€Š [èŠèŠ Windows æœåŠ¡](https://anyesu.github.io/blog/articles/41) ã€‹ã€‚

##### [ä»æ³¨å†Œè¡¨è¯»å–é…ç½®å¼€æœºå¯åŠ¨](https://blog.csdn.net/helloworlddm/article/details/108230925)

æŸ¥çœ‹ä»»åŠ¡ç®¡ç†çš„å¯åŠ¨é¡µçŸ¥é“æœ‰äº›è½¯ä»¶è®¾ç½®äº†å¼€æœºå¯åŠ¨ï¼Œä½†æ‰¾éäº†æœåŠ¡å’Œè®¡åˆ’ä»»åŠ¡éƒ½æ²¡æœ‰å¯¹åº”çš„è®¾ç½®ï¼ŒåŸæ¥æ˜¯åœ¨è¿™äº›æ³¨å†Œè¡¨é¡¹é‡Œé¢ï¼š

```ini
HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run
HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Run
```

##### [é€šè¿‡ç»„ç­–ç•¥è®¾ç½®](https://blog.csdn.net/qq_38684504/article/details/88255081)

##### èµ„æºç®¡ç†å™¨æ’ä»¶é¡¹

æœ‰æ—¶å€™æŠŠä¸Šé¢å‡ ç§å¯åŠ¨æ–¹å¼éƒ½ç¦ç”¨äº†ä»¥åè¿˜æ˜¯ä¼šå¼€æœºå¯åŠ¨ï¼Œå¾€å¾€æ˜¯è¿™äº›æ’ä»¶é€ æˆçš„ï¼Œå®¹æ˜“è¢«å¿½è§†ã€‚æµæ°“è½¯ä»¶åœ¨å®ç°æ’ä»¶åŠŸèƒ½çš„åŸºç¡€ä¸Šè¿˜ä¼šå¢åŠ è°ƒèµ·ä¸»ç¨‹åºçš„æ“ä½œã€‚

- **å³é”®æ‰©å±•èœå•**

  > **FastSearch**

  å³é”®æ–‡ä»¶ã€æ–‡ä»¶å¤¹ã€æ¡Œé¢æ—¶è°ƒç”¨ï¼Œç›¸å½“äºå»¶è¿Ÿå¯åŠ¨ã€‚

- **å›¾æ ‡è¦†ç›–**

  > **FastSearch**

  å›¾æ ‡æ˜¾ç¤ºçš„æ—¶å€™è°ƒç”¨ï¼Œæ˜¾ç¤ºæ¡Œé¢å›¾æ ‡æ—¶åŠ è½½ç›¸å½“äºå¼€æœºå¯åŠ¨äº†ã€‚

- [**ShellExecuteHooks**](https://blog.csdn.net/laiboy/article/details/5755324)

  > **å°é±¼ä¾¿ç­¾**

  ç›¸å…³èµ„æ–™å¾ˆå°‘ï¼Œä¸è¿‡çœ‹åå­— **hook** åº”è¯¥æ˜¯å¯¹ **shell** çš„æ‰§è¡Œè¿‡ç¨‹åšäº†æ‹¦æˆªã€‚

  > [æœ¨é©¬æŠ€æœ¯å‘å±•è¶‹åŠ¿å›é¡¾](https://bbs.csdn.net/topics/330166107)

#### æ€ä¹ˆé¿å…ä¸­æ‹›ï¼Ÿ

ä¸»è¦è¿˜æ˜¯æ³¨æ„ä¸‹è½½è½¯ä»¶çš„ä¹ æƒ¯ï¼š

- èƒ½é€šè¿‡ [å¾®è½¯å•†åº—](https://www.microsoft.com/store) å®‰è£…çš„åº”ç”¨å°½é‡ç”¨å•†åº—å®‰è£…ã€‚

- æŸ¥è¯¢å®˜ç½‘ä¸‹è½½è€Œä¸ç”¨ç¬¬ä¸‰æ–¹ä¸‹è½½ç«™ï¼Œ **å¸¦ `å®˜æ–¹` å°å°¾å·´çš„é‚£ç§** ï¼Œè€Œä¸æ˜¯æ ‡é¢˜åŒ…å«å®˜ç½‘äºŒå­—å°±è¡Œäº†ã€‚æœ‰äº›æ¶å¿ƒçš„ç¬¬ä¸‰æ–¹ç½‘ç«™è¿˜ä¼šæ¨¡ä»¿ç”šè‡³å¤åˆ»å®˜ç½‘çš„é¡µé¢ï¼Œè¦æ³¨æ„åˆ†è¾¨ï¼Œ **æé¬¼** çš„åŸŸåä¸€èˆ¬éƒ½æ˜¯ä¹±ä¸ƒå…«ç³Ÿçš„ã€‚

  ![æœç´¢å®˜ç½‘](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/search_official_website.png)

- æ‰¾å¼€æºè½¯ä»¶ä¸Š [GitHub](https://github.com/search) ï¼Œæ¯”å¦‚æ–‡ä¸­çš„ **ContextMenuManager** ï¼Œæ‰¾åˆ°é¡¹ç›®åœ°å€åè¿› [Releases](https://github.com/BluePointLilac/ContextMenuManager/releases) é¡µé¢ä¸‹è½½æŒ‡å®šç‰ˆæœ¬å³å¯ã€‚ä¸è¦å›¾æ–¹ä¾¿åœ¨è®ºå›æˆ–è€…ç½‘ç›˜ä¸Šä¸‹è½½ï¼Œå› ä¸ºæœ‰å¯èƒ½è¢«ç¯¡æ”¹ï¼ˆ [å‚è€ƒ](https://blog.csdn.net/freedom2017/article/details/3753219) ï¼‰ã€‚

- å®åœ¨ä¸å¾—å·²å»ä¸‹è½½ç«™ï¼Œé¿å¼€ **é«˜é€Ÿä¸‹è½½** å’Œ **å¤§å·çš„ä¸‹è½½æŒ‰é’®** ï¼Œæ‰¾åˆ°å°å·çš„ **ä¸‹è½½åœ°å€** å†é€‰æ‹© **æ™®é€šä¸‹è½½åœ°å€** ï¼ˆ xx ç”µä¿¡ä¸‹è½½ã€ xx è”é€šä¸‹è½½ç­‰ç­‰ ï¼‰ã€‚ä¸€èˆ¬ä¸‹è½½æ­£ç¡®çš„è¯ä¼šæ˜¯ä¸€ä¸ªå‹ç¼©åŒ…ï¼ˆ ä¸€èˆ¬è½¯ä»¶è‡³å°‘æœ‰ **å‡  MB** å¤§å° ï¼‰ï¼Œè€Œé«˜é€Ÿä¸‹è½½å™¨é€šå¸¸æ˜¯ä¸€ä¸ª **å‡ ç™¾ KB** çš„ **exe æ–‡ä»¶** è€Œä¸”æ–‡ä»¶åå«æœ‰ **@** ç¬¦å·å’Œæ±‰å­—ã€‚

  å‹ç¼©åŒ…åˆæ˜¯ä¸€ä¸ªå¤§å‘ï¼Œå› ä¸ºç³»ç»Ÿé»˜è®¤ä¸å¸¦è§£å‹è½¯ä»¶ï¼ˆ **win10** åªæ”¯æŒ **zip** ï¼‰ï¼Œæ‰€ä»¥åˆå¾—å»ä¸‹è§£å‹è½¯ä»¶â€¦â€¦

  **ç»è¿‡ 3Â·15 æ›å…‰ï¼Œä¸»æµä¸‹è½½ç«™æ•´é¡¿åéƒ½æ‰¾ä¸åˆ°é«˜é€Ÿä¸‹è½½æŒ‰é’®äº†ï¼Œå·²ä¸‹è½½çš„ P2P ä¸‹å´½å™¨ä¹Ÿæ–­ç½‘äº†ã€‚**

#### æœ‰å“ªäº›æµæ°“è½¯ä»¶ï¼Ÿ

ä¸€èˆ¬ **è§£å‹** ã€ **çœ‹å›¾** ã€ **PDF** è¿™å‡ ç±»è½¯ä»¶æ˜¯å¿…å¤‡è½¯ä»¶ï¼Œæ‰€ä»¥æ˜¯ä¸‹è½½é‡ç¾åŒºï¼Œå…¶ä»–åŸºæœ¬æ˜¯é™„èµ çš„ã€‚é™¤äº† **SoftCnKiller** [é»‘åå•](https://gitee.com/softcnkiller/data/blob/master/Descrip/å…³äºæ•°ç­¾signè¯´æ˜.txt) ä¸­åˆ—å‡ºæ¥çš„ä»¥å¤–å†è¡¥å……å‡ ä¸ªï¼š

> é£ç«åŠ¨æ€å£çº¸ æµ·èºæ¡Œé¢
>
> å—¨æ ¼å¼æ•°æ®æ¢å¤å¤§å¸ˆ å¤±æ˜“å¾—æ•°æ®æ¢å¤ ä¸‡èƒ½æ¢å¤å¤§å¸ˆ
>
> 2345 å…¨å®¶æ¡¶ 360 å…¨å®¶æ¡¶ é‡‘å±±å…¨å®¶æ¡¶ é²å¤§å¸ˆ é©±åŠ¨äººç”Ÿ é©±åŠ¨ç²¾çµ ç‘æ˜Ÿæ€æ¯’ å…‰é€Ÿæœç´¢ æ‰‹æœºæ¨¡æ‹Ÿå™¨å¤§å¸ˆ

æˆ‘å¸¸ç”¨çš„å‡ æ¬¾è½¯ä»¶ï¼ˆ **ä»…ä¾›å‚è€ƒï¼Œçœ‹ä¸ªäººå–œå¥½è‡ªè¡Œé€‰æ‹©** ï¼‰ï¼š

- **æµè§ˆå™¨** - [Chrome](https://www.google.cn/chrome?standalone=1)

  æ–°ç‰ˆ **Edge** ç¡®å®è¿˜è¡Œï¼Œä½†æ˜¯åˆ°å¤„éƒ½æ˜¯æ— è„‘å®‰åˆ© **Edge** çš„å°±å¾ˆåæ„Ÿï¼Œè·Ÿå½“åˆ **360 æµè§ˆå™¨** ä¸€æ ·ã€‚è€Œä¸”æ–°ç‰ˆç³»ç»Ÿç›´æ¥æ·±åº¦æ†ç»‘ï¼Œæ„å¤–å‘ç°è™šæ‹Ÿæœºé‡Œçš„ **Edge** åœ¨æ§åˆ¶é¢æ¿è¿˜éšè—äº†å¸è½½é€‰é¡¹ï¼Œä¸çŸ¥é“åˆ«çš„ç”µè„‘ä¸Šæ˜¯ä¸æ˜¯ä¹Ÿè¿™æ ·ã€‚

  é¡ºä¾¿æä¸€ä¸‹é‚£ä¸ªå‚»ç“œå¼åŒæ­¥åŠŸèƒ½ï¼ˆ æˆ‘è‡ªå·±æ˜¯ä»æ¥ä¸ç”¨çš„ ï¼‰çœŸçš„å¾ˆå‚»ç“œï¼šåŒæ­¥æ—¶æœºä¸ç¡®å®šï¼ŒåŒæ­¥è¿›åº¦å’Œç»“æœçœ‹ä¸åˆ°ï¼Œè¯¥ä¿å­˜çš„æ•°æ®ç»™å¼„ä¸¢äº†ï¼Œä¸è¯¥åŒæ­¥çš„éšç§æ•°æ®ç»™ä¼ äº‘ç«¯å»ï¼Œè§£å†³å†²çªçš„èƒ½åŠ›çº¦ç­‰äºé›¶ï¼Œè¿˜ä¸å¦‚ç»™ä¸¤ä¸ªæŒ‰é’®è®©ç”¨æˆ·æ‰‹åŠ¨é€‰æ‹©åŒæ­¥åˆ°äº‘ç«¯è¿˜æ˜¯åŒæ­¥åˆ°æœ¬åœ°ã€‚æˆ‘çš„åšæ³•æ˜¯å®šæœŸå¤‡ä»½ä¹¦ç­¾ï¼ˆ æˆ–è€…è€ƒè™‘æ‰¾æ’ä»¶ï¼Ÿ ï¼‰å’Œæ’ä»¶æºæ–‡ä»¶ï¼Œå³ä½¿æ˜¯å¤šè®¾å¤‡ä½¿ç”¨ä¹Ÿæ˜¯åªåœ¨ä¸€å°æœºå™¨ä¸Šä¿®æ”¹ï¼Œå…¶ä»–æœºå™¨æ‰‹åŠ¨åŒæ­¥ã€‚

  åœ¨å›½å†… **Edge** è¢«å¹çˆ†ä¸»è¦ä¹Ÿæ˜¯å› ä¸ºå¯ä»¥åŒæ­¥ï¼Œä¸è¿‡ç”±äº **DNS æ±¡æŸ“** ä¹Ÿæ˜¯åŠå¢™çš„çŠ¶æ€ã€‚

  > [å¦‚ä½•è§£å†³ Edge æµè§ˆå™¨æ— æ³•ç¿»è¯‘åŠä¸‹è½½/åŒæ­¥æ‰©å±•é—®é¢˜](https://zhuanlan.zhihu.com/p/457789773)

- **å›¾ç‰‡** - **2345 çœ‹å›¾ç‹** `ç»¿è‰²å»å¹¿å‘Šç‰ˆ`

- **å‹ç¼©æ–‡ä»¶** - [Bandizip](http://www.bandisoft.com) `æœ€åæ— å¹¿å‘Šç‰ˆæœ¬ ( 6.25 )`

- **PDF** - æ²¡æœ‰ç¼–è¾‘éœ€æ±‚ç”¨æµè§ˆå™¨æ‰“å¼€å°±è¡Œäº†ï¼ˆ **2345 çœ‹å›¾ç‹** ä¹Ÿæ”¯æŒ ï¼‰

### æ¸…ç†æ€è·¯

---

äº†è§£äº†æµæ°“è½¯ä»¶çš„å­˜æ´»æœºåˆ¶å°±å¯ä»¥é‡‡å–å¯¹åº”çš„æªæ–½ï¼š

- æ–­ç½‘ä»¥éš”ç»è¿›ä¸€æ­¥æ„ŸæŸ“ä»¥åŠå’Œå…¶ä»–è®¾å¤‡çš„äº¤å‰æ„ŸæŸ“ã€‚

- ç¦æ­¢è‡ªåŠ¨è¿è¡Œå¹¶ç»“æŸæ‰€æœ‰ç›¸å…³è¿›ç¨‹ï¼Œé¿å…ç»§ç»­äº§ç”Ÿå½±å“ã€‚

  æœ‰äº›è¿›ç¨‹æ£€æµ‹åˆ°è‡ªå·±çš„æœåŠ¡è¢«ç¦ç”¨åä¼šè‡ªåŠ¨è¿›è¡Œä¿®å¤ï¼Œä¸è¿‡ä¸€èˆ¬ä¼šæœ‰ä¸€ä¸ªè¾ƒé•¿çš„æ—¶é—´é—´éš”ï¼Œæ‰€ä»¥å…ˆæ€è¿›ç¨‹å†ç¦ç”¨è¿˜æ˜¯å…ˆç¦ç”¨å†æ€åœ¨é¡ºåºä¸Šå½±å“ä¸å¤§ï¼Œé æ‰‹é€Ÿå®Œå…¨æ¥å¾—åŠã€‚

- æ¸…ç†æºæ–‡ä»¶ã€‚

å¸¸è§„æ¸…ç†æµç¨‹è¿˜æ˜¯ä»¥å…ˆå¸è½½ä¸ºä¸»ï¼Œè¾…ä»¥æ¸…ç†æ®‹ç•™é…ç½®å’Œæ–‡ä»¶ï¼Œ **ç½‘ä¸Šå¾ˆå¤šäººåæ˜ ä¸€äº›è½¯ä»¶æ€ä¹ˆåˆ éƒ½åˆ ä¸æ‰æˆ–è€…åˆ äº†åˆå‡ºæ¥äº†å¾€å¾€æ˜¯å› ä¸ºæ®‹ç•™æ–‡ä»¶æ²¡å»æ¸…ç†å¯¼è‡´çš„ã€‚**

### æ­å»ºæµ‹è¯•ç¯å¢ƒ

---

æ—¢ç„¶æ˜¯è¦æµ‹è¯•ï¼Œé‚£è‡ªç„¶å¾—å…ˆæŠŠæµæ°“è½¯ä»¶å…»è›Šçš„ç¯å¢ƒæ­èµ·æ¥ã€‚è™½ç„¶æœ‰å¤šæ¬¡æ¸…ç†çš„ç»éªŒï¼Œä½†ä¹Ÿä¸ä¿è¯èƒ½å®Œå…¨æ¸…ç†å¹²å‡€ï¼Œåœ¨ç”µè„‘ä¸Šç•™äº†åé—¨å°±éº»çƒ¦äº†ï¼Œè¿˜æ˜¯åœ¨è™šæ‹Ÿæœºé‡Œè¿è¡Œæ¯”è¾ƒå¥½ï¼Œæµ‹è¯•å®Œæ¯•ç›´æ¥æ‰“åŒ…åˆ æ‰ã€‚

#### å®‰è£… [VMware](https://www.vmware.com/products/workstation-pro/workstation-pro-evaluation.html)

ä¸´æ—¶ä½¿ç”¨ï¼Œä»å®˜ç½‘ä¸‹è½½æœ€æ–°ç‰ˆè¯•ç”¨ **30** å¤©å³å¯ã€‚

#### åˆ›å»ºè™šæ‹Ÿæœº

é•œåƒæ˜¯ä¹‹å‰é‡è£…ç³»ç»Ÿå‰©ä¸‹æ¥çš„ï¼Œç¡¬ä»¶é…ç½®ï¼š **4 C** / **8 G** å†…å­˜ / **30 G** ç¡¬ç›˜ / **NAT** ç½‘ç»œã€‚

æ­£å¸¸ä½¿ç”¨æ—¶å ç”¨ç©ºé—´å¤§æ¦‚ **19 G**ï¼ˆ å…³æœºåå¤§æ¦‚ **11 G** ï¼‰ï¼Œæ‰€ä»¥ç¡¬ç›˜å¯ä»¥é€‚å½“å†å¤§ç‚¹ã€‚

ä½¿ç”¨ [ç®€æ˜“å®‰è£…](https://docs.vmware.com/en/VMware-Workstation-Pro/16.0/context?id=IDH_EASY_INSTALL) çš„æ–¹å¼ï¼Œæ¯”å¹³å¸¸è£…ç³»ç»Ÿå¿«å¤šäº†ï¼Œå…¨ç¨‹è‡ªåŠ¨è®¾ç½®ï¼Œè¿›æ¡Œé¢å°±å¯ä»¥ç›´æ¥ç”¨äº†ã€‚

![è™šæ‹Ÿæœºåˆšè£…å®Œ](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/vmware_init.png)

è™šæ‹Ÿæœºæ­£å¸¸å¼€æœºåï¼Œå»ºè®®å…ˆä¿å­˜ä¸€ä¸ªå¿«ç…§ç”¨äºå›æ»šï¼Œå›æ»šè·Ÿ **æŒ‚èµ·/è¿˜åŸ** ä¸€æ ·å¿«ï¼Œåªæ˜¯æ¯ä¸ªå¿«ç…§ä¼šå ç”¨å¾ˆå¤šç¡¬ç›˜ç©ºé—´ï¼ˆ çœ‹è™šæ‹Ÿæœºå®é™…çš„æ•°æ®é‡ ï¼‰ã€‚

#### å®‰è£…æµæ°“è½¯ä»¶

éšä¾¿æ‰¾ä¸€ä¸ªä¸‹è½½ç«™ **é«˜é€Ÿ** ä¸‹è½½ **é£å‹** æˆ–è€…å…¶ä»–ä»€ä¹ˆå°è½¯ä»¶ï¼Œ **ä¸ºäº†åŠ å¿«ä¸‹å´½è¿›åº¦å¯ä»¥æŠŠå®‰è£…ç¨‹åºå¤åˆ¶ 10 ä»½ç„¶åä¾æ¬¡æ‰§è¡Œï¼Œæ¯æ¬¡å°±ä¼šæ†ç»‘ä¸åŒçš„è½¯ä»¶** ã€‚çœ‹åˆ° **è…¾è®¯æ‰‹æ¸¸åŠ©æ‰‹** çš„æ—¶å€™æ³¨æ„æš‚åœï¼Œå› ä¸ºä¼šè‡ªåŠ¨ä¸‹è½½æ¯”è¾ƒå¤§çš„æ¸¸æˆï¼Œå¾ˆå®¹æ˜“æ’‘çˆ†è™šæ‹Ÿæœºçš„ç¡¬ç›˜ï¼ˆ æˆ‘å‰é¢åˆ†é…çš„ç¡¬ç›˜ç©ºé—´å¾ˆå° ï¼‰ã€‚

**é£å‹** æœ¬ä½“å®‰è£…å®Œä»¥å **å®‰è£…ç¨‹åº** çš„çª—å£å°±ä¸è§äº†ï¼Œä½†æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨å¯ä»¥å‘ç°è¿™ä¸ªè¿›ç¨‹å®é™…ä¸Šè¿˜åœ¨åå°è¿è¡Œï¼Œç½‘é€Ÿè¿˜æ—¶ä¸æ—¶æ‹‰æ»¡ï¼Œè¯´æ˜æ­£åœ¨ä¸æ–­å®‰è£…æ–°çš„è½¯ä»¶ã€‚æœ€ç»ˆæ•ˆæœè§æ–‡ç« é¦–å›¾ã€‚

> è¿˜æ˜¯ **P2P ä¸‹å´½å™¨** æ¯”è¾ƒç»™åŠ›ï¼Œä¸€ä¸‹ä¸€çªå´½ã€‚

### å¼€å§‹æ¸…ç†

---

#### åœæ­¢ P2P ä¸‹å´½å™¨

æ‰“å¼€ä»»åŠ¡ç®¡ç†å™¨ç»“æŸæ‰æ­£åœ¨æ‰§è¡Œçš„ **P2P ä¸‹å´½å™¨** è¿›ç¨‹ï¼Œä»¥é¿å…æˆ‘ä»¬ä¸€è¾¹åœ¨åˆ ä¸œè¥¿å®ƒä¸€è¾¹ç»™æˆ‘ä»¬è£…å›å»ã€‚å¦‚æœåˆ†ä¸æ¸…æ¥šæ˜¯å“ªä¸ªè¿›ç¨‹ï¼Œå°±ç›´æ¥é‡å¯ç”µè„‘ã€‚

#### è¿›å…¥å®‰å…¨æ¨¡å¼ï¼ˆ å¯é€‰ ï¼‰

è¿›å…¥å®‰å…¨æ¨¡å¼å¯ä»¥ç¦ç”¨é™¤ç³»ç»Ÿå¤–çš„ç¬¬ä¸‰æ–¹ç¨‹åºå¼€æœºå¯åŠ¨ï¼ˆ é€‰æ‹© **è¯Šæ–­å¯åŠ¨** å¯è¿›ä¸€æ­¥ç¦ç”¨æ€æ¯’è½¯ä»¶ ï¼‰ï¼Œä¸”é»˜è®¤æ— ç½‘ç»œï¼Œå¯ä»¥å¾ˆå¥½åœ°é¿å…æˆ‘ä»¬æ¸…ç†çš„æ—¶å€™æ¶æ„ç¨‹åºåœ¨åè¾¹æ£ä¹±ã€‚

ç†è®ºä¸Šåªæ˜¯æ¸…ç†æµæ°“è½¯ä»¶ä¸è¿›å®‰å…¨æ¨¡å¼ä¸æ–­ç½‘ä¹Ÿæ²¡é—®é¢˜ï¼Œ **å¦‚æœç¡®è®¤æ˜¯ç—…æ¯’æ„ŸæŸ“æˆ–è€…æ¥ä¸åŠæ€è¿˜æ˜¯å»ºè®®è¿›å®‰å…¨æ¨¡å¼ï¼Œåªæœ‰é­”æ³•æ‰èƒ½æ‰“è´¥é­”æ³•ã€‚**

ç½‘ä¸Šæ‰¾çš„æ–¹æ³•ï¼š

> - **win 7** åŠ **XP** å¼€æœºç–¯ç‹‚æŒ‰ `F8` å°±èƒ½è·³å‡ºå®‰å…¨æ¨¡å¼çš„èœå•äº†ã€‚
> - **win10** æŒ‰ä½ `Shift` ä¸æ¾å¼€ > å¼€å§‹ > ç”µæº > é‡å¯ > è¿›å…¥æ¢å¤æ¨¡å¼ > ç–‘éš¾è§£ç­” > é«˜çº§é€‰é¡¹ > å¯åŠ¨è®¾ç½® > é‡å¯ã€‚

ä¸€æ­¥åˆ°ä½çš„æ–¹æ³•ï¼š `win + R` > `msconfig` > å¼•å¯¼ > å¼•å¯¼é€‰é¡¹ > å‹¾é€‰å®‰å…¨å¼•å¯¼ > æŒ‰éœ€é€‰æ‹©å¯åŠ¨å‚æ•°ï¼ˆ ä¸»è¦æ˜¯æœ‰æ— ç½‘ç»œ ï¼‰ > åº”ç”¨ > é‡å¯ã€‚ï¼ˆ é€€å‡ºå®‰å…¨æ¨¡å¼æ—¶éœ€è¦å–æ¶ˆå‹¾é€‰å®‰å…¨å¼•å¯¼ ï¼‰

![win + R > msconfig](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/msconfig.png)

è¿˜å¯ä»¥é€šè¿‡ä¿®æ”¹ [BCD](https://docs.microsoft.com/windows-hardware/manufacture/desktop/bcdedit-command-line-options) è¿›å®‰å…¨æ¨¡å¼ï¼Œé€‚ç”¨äºç³»ç»Ÿæ­£å¸¸å¯åŠ¨ä¸äº†çš„æƒ…å†µï¼Œä¿®æ”¹å“ªäº›å±æ€§ä¸€æ—¶è®²ä¸æ¸…æ¥šï¼Œä¸è¿‡ä¸€èˆ¬çš„ **BCD å·¥å…·** ï¼ˆ æ¯”å¦‚ [BOOTICE](http://bbs.wuyou.net/forum.php?mod=viewthread&tid=57675) ï¼‰éƒ½æä¾›äº†ç±»ä¼¼ **msconfig** ä¸€æ ·çš„å‹å¥½ç•Œé¢å¯ä»¥å¿«é€Ÿè®¾ç½®ã€‚

#### å¸è½½ç¨‹åº

æ‰“å¼€æ§åˆ¶é¢æ¿ï¼ˆ å®‰è£…æ—¶é—´å€’åºï¼Œè™½ç„¶èƒ½é€ å‡ ï¼‰ï¼Œçœ‹åˆ°é‚£äº›ä¸è®¤è¯†çš„è½¯ä»¶ï¼ˆ é™¤äº†å¾®è½¯å­—æ ·çš„ ï¼‰éƒ½å¯ä»¥å¸è½½äº†ã€‚æ¡Œé¢çš„å¼¹çª—å¹¿å‘Šå¯ä»¥ä¸ç”¨ç®¡ï¼Œå¸è½½çš„æ—¶å€™ä¼šè‡ªåŠ¨å…³é—­ã€‚

å¸è½½ç¨‹åºçš„æ³¨å†Œä¿¡æ¯åœ¨ä»¥ä¸‹æ³¨å†Œè¡¨é¡¹ä¸­ï¼šï¼ˆ [å‚è€ƒ](https://docs.microsoft.com/windows/win32/shell/cpl-setprogramaccess#filtering-the-add-or-remove-programs-list) ï¼‰

```ini
HKCU\Software\Microsoft\Windows\CurrentVersion\Uninstall
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Uninstall
```

**æ³¨æ„å¸è½½ç¨‹åºä¸­çš„å„ç§äº¤äº’é™·é˜±ï¼Œçœ‹ä»”ç»†äº†å†ç‚¹å‡»ã€‚å¦å¤–ï¼Œæœ‰äº›è€æµæ°“ä¼šæŠŠä¸€é”®å»å¹¿å‘Šçš„åŠŸèƒ½æ”¾åœ¨å¸è½½ç¨‹åºé‡Œé¢ã€‚**

å¦‚æœæç¤º **æ­¤æ“ä½œåªå¯¹ç›®å‰å®‰è£…çš„äº§å“æœ‰æ•ˆ** ï¼Œå…¶å®åªæ˜¯æ³¨å†Œè¡¨æ®‹ç•™è€Œå·²ï¼Œå¯ä»¥ç›´æ¥åˆ æ‰ï¼ˆ [å‚è€ƒ](https://www.zhihu.com/question/503525075/answer/2261933568) ï¼‰ã€‚

**å¤ç°æ–¹æ³•ï¼š** æ‹–ä¸€ä¸ªå¿«æ·æ–¹å¼åˆ° **Total Uninstall** çš„ç¨‹åºåˆ—è¡¨å³å¯æ·»åŠ  **å·²å®‰è£…ç¨‹åº** ï¼Œå®šä½åˆ°æ³¨å†Œè¡¨åˆ æ‰ **UninstallString** é¡¹ï¼Œå†å»æ§åˆ¶é¢æ¿å¸è½½çœ‹çœ‹ã€‚

##### ç¬¬ä¸‰æ–¹å¸è½½å·¥å…·

è¯•ç”¨äº†å‡ ä¸ªç½‘ä¸Šæ¨èçš„å·¥å…·ï¼š

- [IObit Uninstaller](https://www.iobit.com/en/advanceduninstaller)

  ç•Œé¢ä¸Šçœ‹ä¼¼ä¸€å †èŠ±é‡Œèƒ¡å“¨çš„åŠŸèƒ½ï¼Œå®é™…æœ‰ç”¨çš„åŠŸèƒ½ä¹Ÿåªæ˜¯å¸è½½ã€‚å¯ä»¥æ‰¹é‡å¸è½½å¹¶æ¸…ç†æ®‹ç•™æ–‡ä»¶ï¼Œå°±æ˜¯é€Ÿåº¦æœ‰ç‚¹æ…¢ï¼ˆ æ€€ç–‘è¿›åº¦æ¡è½¬åœˆçš„é€Ÿåº¦å›ºå®šæ­»äº† ï¼‰ã€‚

  å®‰è£…ç›‘è§†å™¨è¿˜ä¸é”™ï¼Œå®‰è£…çš„æ—¶å€™è®°å½•ä¿®æ”¹å†…å®¹ï¼ˆ æ–‡ä»¶ã€æ³¨å†Œè¡¨ç­‰ ï¼‰ï¼Œå¸è½½çš„æ—¶å€™æ ¹æ®è¿™ä¸ªè®°å½•è¿›è¡Œå›æ»šï¼Œå¸è½½å¾—æ›´å¹²å‡€ã€‚

  ![IObit Uninstaller](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/iobit_uninstaller.png)

  ![IObit Uninstaller2](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/iobit_uninstaller2.png)

  ![IObit Uninstaller3](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/iobit_uninstaller3.png)

  **æ³¨æ„ï¼šä¸è¦å¼ºåŠ›å¸è½½ä¸€ä¸ªå¿«æ·æ–¹å¼ï¼Œä¸€ä¸å°å¿ƒå¯èƒ½å°±æŠŠç³»ç»Ÿæ–‡ä»¶ç»™åˆ äº†ï¼ˆ è™½ç„¶ä¸ä¸€å®šæœ‰æƒé™ ï¼‰ã€‚**

  ![IObit Uninstaller4](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/iobit_uninstaller4.png)

- [GEEK UNINSTALLER](https://geekuninstaller.com)

  å…å®‰è£…ï¼Œæ”¯æŒç­›é€‰ã€‚åŠŸèƒ½è¿˜æ˜¯æ¯”è¾ƒç®€å•ï¼Œä¸“ä¸šç‰ˆï¼ˆ [Uninstall Tool](https://crystalidea.com/uninstall-tool) ï¼‰æ‰æ”¯æŒæ‰¹é‡å¸è½½å’Œ **è¿½è¸ªå®‰è£…** ã€‚

  ![GEEK UNINSTALLER](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/geek_uninstaller.png)

  ![GEEK UNINSTALLER2](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/geek_uninstaller2.png)

- [HiBit Uninstaller](http://hibitsoft.ir/Uninstaller.html)

  å…å®‰è£…ï¼Œæ‹–ä¸€ä¸ªå¿«æ·æ–¹å¼è¿›å»å°±å¯ä»¥å¸è½½äº†ï¼Œæ”¯æŒæ‰¹é‡å¸è½½ã€åå°é™é»˜å¸è½½ã€ç¼–è¾‘å¸è½½ä¿¡æ¯ã€å¤±è´¥é‡è¯•ï¼Œè¿˜è‡ªå¸¦äº†ä¸€äº›æ¸…ç†å·¥å…·ã€‚ç”±äºæ˜¯ç­‰æ‰€æœ‰åŸå§‹å¸è½½ç¨‹åºæ‰§è¡Œå®Œä¹‹åå†ä¸€æ¬¡æ€§æ‰«æçš„ï¼Œæ¯”èµ· **IObit Uninstaller** é€Ÿåº¦ä¼šå¿«å¾ˆå¤šã€‚

  ![HiBit Uninstaller](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/hibit_uninstaller.png)

- [~~å¯ç‰›ç”µè„‘åŠ©æ‰‹~~](https://zs.keniu.com)

  æœ¬èº«å°±æ˜¯ä¸ªæµæ°“è½¯ä»¶ï¼Œåœ¨å®ƒèº«ä¸Šçœ‹åˆ°äº† **2345 å…¨å®¶æ¡¶** çš„å½±å­ï¼Œ **ä¸æ¨è** ã€‚

- [Total Uninstall](https://www.martau.com)

  ä¸€ä¸ªæƒŠå–œè½¯ä»¶ï¼Œç•Œé¢è™½ç„¶ä¸æ€ä¹ˆå¥½çœ‹ï¼Œä½†åŠŸèƒ½æ¯”å‰é¢çš„å·¥å…·æ›´å¼ºå¤§ã€‚åˆ«çš„å·¥å…·å¤§éƒ½æ˜¯å¸è½½åå†åˆ†ææ®‹ç•™ï¼ˆ ç”¨æˆ·è§’åº¦ ï¼‰ï¼Œè€Œå®ƒæ˜¯å…ˆåˆ†æå†å¸è½½çš„ï¼Œæœ‰å“ªäº›ä¿®æ”¹ä¸€ç›®äº†ç„¶ï¼Œè¿˜æ”¯æŒå¯¼å‡ºå¸è½½é…ç½®ä¸ºæ³¨å†Œè¡¨æ–‡ä»¶ï¼Œé€‚åˆåšå•çº¯çš„æ†ç»‘åˆ†æå·¥å…·ã€‚

  - æ”¯æŒå¸è½½å¤‡ä»½å’Œè¿˜åŸï¼Œé€šè¿‡å¤‡ä»½çš„æ—¥å¿—å¯ä»¥æŸ¥çœ‹æ®‹ç•™ã€‚
  - æ”¯æŒæ‹–æ”¾å¿«æ·æ–¹å¼æ·»åŠ å¸è½½åˆ—è¡¨æ²¡æœ‰çš„ç¨‹åºè¿›è¡Œåˆ†æã€‚
  - æ³¨å†Œè¡¨åˆ†ææ›´å½»åº•ã€‚
  - æ”¯æŒæŸ¥è¯¢ ~~å…³è”~~ ï¼ˆ æ†ç»‘ ï¼‰çš„ç¨‹åºï¼Œè…¾è®¯å…¨å®¶æ¡¶å’Œé©±åŠ¨ç±»è½¯ä»¶å®¹æ˜“è¯¯åˆ ã€‚

  ![Total Uninstall](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/total_uninstall.png)

- [CCleaner](https://www.ccleaner.com)

  ä¸€æ¬¾æ¸…ç†å·¥å…·ï¼Œå¾ˆä¹…ä»¥å‰ç”¨è¿‡ï¼Œå¿˜äº†ä»€ä¹ˆåŸå› å¼ƒå‘äº†ï¼Œæœ‰éœ€è¦çš„è‡ªè¡Œäº†è§£ã€‚

ä»¥ä¸Šå‡ æ¬¾è½¯ä»¶åŸºæœ¬éƒ½æ”¯æŒå®šä½åˆ°å®‰è£…ç›®å½•å’Œæ³¨å†Œè¡¨ï¼Œå’Œæ§åˆ¶é¢æ¿æ˜¾ç¤ºçš„ç¨‹åºæ•°é‡åŸºæœ¬ä¸€è‡´ï¼ˆ åº”è¯¥éƒ½æ˜¯ä»æ³¨å†Œè¡¨è¯»å–çš„ ï¼‰ï¼Œéƒ½æ”¯æŒå¼ºåŠ›å¸è½½ï¼ˆ è‡ªå¸¦å¸è½½ç¨‹åº + æ¸…ç†æ®‹ç•™å†…å®¹ ï¼‰ï¼Œè™½ç„¶éƒ½è¾¾ä¸åˆ°å®Œå…¨å¸è½½çš„ç¨‹åº¦ï¼Œä½†è¿˜æ˜¯æ¯”ä»æ§åˆ¶é¢æ¿å¸è½½è¦å¹²å‡€è®¸å¤šã€‚

**ä¸è¿‡æœ¬æ–‡è¿˜æ˜¯é‡‡ç”¨åŸç”Ÿçš„æ§åˆ¶é¢æ¿å¸è½½æ–¹å¼ï¼Œæ¯•ç«Ÿæ›´è´´è¿‘å¹¿å¤§ç”¨æˆ·çš„ä½¿ç”¨ç¯å¢ƒã€‚** ç¼ºç‚¹æ— éæ˜¯å¤šèŠ±ç‚¹æ—¶é—´è€Œå·²ï¼Œæ¯•ç«Ÿæ­£å¸¸äººå¶å°”æ‰ä¼šä¸­æ‹›ï¼Œæ¶ˆè€—è¿™ç‚¹æ—¶é—´ä¹Ÿèƒ½æ¥å—ï¼Œå¤©å¤©ä¸­æ‹›è¯´æ˜çœŸçš„ä¸é€‚åˆç”¨ç”µè„‘ã€‚

å¸è½½å·¥å…·çš„è¯å…¶å®æˆ‘ä¹Ÿä¸å»ºè®®ç”¨ï¼Œå› ä¸º **å± é¾™å‹‡å£«ç»ˆæˆæ¶é¾™** ã€‚è€Œä¸” **é“é«˜ä¸€å°ºé­”é«˜ä¸€ä¸ˆ** ï¼Œè€æµæ°“çš„æ‰‹æ®µä¹Ÿåœ¨ä¸æ—¶ä¿±è¿›ï¼ŒæŒæ¡å¥½æ–¹æ³•æ‰æ˜¯ç‹é“ã€‚

![å¸è½½å®Œæˆ](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/base_uninstall.png)

åˆæ­¥å¸è½½å®Œæ¯•å„ç§å¼¹çª—å’Œå¹¿å‘ŠåŸºæœ¬éƒ½æ²¡äº†ï¼Œæ¯•ç«Ÿå¤§éƒ¨åˆ†è½¯ä»¶è¿˜æ˜¯æ¯”è¾ƒè‰¯å¿ƒåœ°æä¾›äº†å¸è½½ç¨‹åºï¼Œå¸è½½å¾—ä¹Ÿæ¯”è¾ƒå¹²å‡€ï¼Œä¼°è®¡å¼€å‘è€…è‡ªå·±ä¹Ÿæ·±å—å…¶å®³ä¸å¾—ä¸ç•™æ¡åè·¯ã€‚

**æœ‰éœ€è¦å¯ä»¥å…ˆé‡å¯ä¸‹ç”µè„‘ï¼Œä¸€äº›æ®‹ç•™æ–‡ä»¶éœ€è¦é‡å¯æ‰ä¼šè‡ªåŠ¨åˆ é™¤ã€‚**

#### åˆ é™¤æ®‹ç•™å¼€æœºå¯åŠ¨é¡¹

##### åˆ é™¤æœåŠ¡

```ini
HKLM\SYSTEM\CurrentControlSet\Services\{ServiceName}
```

> ä»»åŠ¡ç®¡ç†å™¨ > æœåŠ¡ > éšä¾¿é€‰ä¸­ä¸€ä¸ªæœåŠ¡å³é”® > æ‰“å¼€æœåŠ¡

ä¸€ä¸ªä¸€ä¸ªæ’æŸ¥ï¼ˆ åŒå‡»æŸ¥çœ‹æ‰§è¡Œè·¯å¾„ ï¼‰ï¼Œéœ€è¦ç•™æ„ä¸‹ **svchost** è¿›ç¨‹ï¼Œæœ‰äº›æµæ°“è½¯ä»¶å°±æ˜¯é€šè¿‡ **svchost** çš„æ–¹å¼å¯åŠ¨ä»¥å®ç°éšè—è‡ªèº«çš„ç›®çš„ã€‚ï¼ˆ [å‚è€ƒ](https://blog.csdn.net/yangyuankp/article/details/8170720) ï¼‰

![æœåŠ¡ - svchost](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/service_svchost.png)

**PowerShell** åˆ—å‡ºæ‰€æœ‰æœåŠ¡ï¼š

```powershell
$Dll = @{n="Dll";e={ (gp "HKLM:\SYSTEM\CurrentControlSet\Services\$($_.Name)\Parameters" -ErrorAction Ignore).ServiceDll }}
gwmi win32_service |
    select $Dll, Name, DisplayName, State, Status, StartMode, PathName, Description, processId |
    ogv -Title 'æœåŠ¡ by anyesu'
```

æ‰¹å¤„ç†åˆ é™¤æœåŠ¡ï¼ˆ **ç®¡ç†å‘˜æƒé™** ï¼‰ï¼š

```powershell
:: æ³¨æ„æ˜¯æœåŠ¡åè€Œä¸æ˜¯æ˜¾ç¤ºåç§°
sc stop XIAOYUUPDATE & sc delete XIAOYUUPDATE
```

å¦‚æœç›´æ¥åˆ é™¤æœåŠ¡è€Œæœªå…³é—­å°±ä¼šåªæ ‡è®°ä¸ºåˆ é™¤ï¼Œæ‰‹åŠ¨å…³è¿›ç¨‹æˆ–è€…é‡å¯åæ‰ä¼šå½»åº•åˆ é™¤ã€‚æœ‰äº›æœåŠ¡çš„åœæ­¢æŒ‰é’®ä¸å¯ç‚¹å‡»ä¸€èˆ¬è¯´æ˜æœ‰å…¶ä»–å…³è”æœåŠ¡æ§åˆ¶ç€ï¼Œåªæ˜¯å•ç‹¬åˆ äº†é‡å¯è¿˜å¯èƒ½è¿˜åŸå›æ¥ã€‚

> [è§£å†³â€œæŒ‡å®šçš„æœåŠ¡å·²ç»æ ‡è®°ä¸ºåˆ é™¤â€é—®é¢˜](https://www.cnblogs.com/C-Shark/archive/2011/03/19/1989032.html)

è¿™ä¹ˆæŸ¥è¿˜æ˜¯å¾ˆè´¹åŠ²çš„ï¼Œå€ŸåŠ© **Autoruns** å·¥å…·æˆ‘ä»¬å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æŸ¥çœ‹ç¬¬ä¸‰æ–¹æœåŠ¡ï¼Œå³é”®å¯ç›´æ¥åˆ é™¤æœåŠ¡ã€‚

![æŸ¥çœ‹æœåŠ¡](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/autoruns_service.png)

##### åˆ é™¤è®¡åˆ’ä»»åŠ¡

> æ§åˆ¶é¢æ¿ > æœç´¢è®¡åˆ’ä»»åŠ¡
>
> æˆ–è€… `win + R` > `taskschd.msc`

![æŸ¥çœ‹è®¡åˆ’ä»»åŠ¡](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/autoruns_taskschd.png)

ä¸€èˆ¬åˆ æ‰ `ä»»åŠ¡è®¡åˆ’ç¨‹åºåº“` ç›®å½•å’Œ `Microsoft\windows` ç›®å½•ä¸‹çš„ç›´æ¥å­ä»»åŠ¡å³å¯ã€‚åŒå‡»ä»»åŠ¡æŸ¥çœ‹æ“ä½œï¼Œæ¯”èµ·æœåŠ¡å¥½åˆ†è¾¨å¤šäº†ï¼Œå³é”®å¯åˆ é™¤ã€‚

**PowerShell** æŸ¥è¯¢ï¼ˆ **ç®¡ç†å‘˜æƒé™æŸ¥çœ‹æ‰€æœ‰çš„ä»»åŠ¡** ï¼‰ï¼š

```powershell
Get-ScheduledTask |
    ? { ('\', '\Microsoft\windows') -contains $_.TaskPath } |
    select TaskPath, TaskName, Description, Author, State |
    ogv -Title 'è®¡åˆ’ä»»åŠ¡ by anyesu'
```

##### åˆ é™¤å¼€å§‹èœå•å¯åŠ¨é¡¹

> [win10 startup å¯åŠ¨ç›®å½•è·¯å¾„å‘½ä»¤](https://www.cnblogs.com/wswind/p/10078682.html)

```powershell
explorer shell:startup
explorer shell:common startup
```

![ã€Œå¼€å§‹ã€èœå• > ç¨‹åº > å¯åŠ¨](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/startmenu_startup.png)

##### åˆ é™¤æ³¨å†Œè¡¨å¯åŠ¨é¡¹

> - [Use Shell Launcher (Standard 7 SP1)](<https://docs.microsoft.com/previous-versions/windows/embedded/ff794318(v=winembedded.60)>)
> - [Use Shell Launcher to create a Windows client kiosk](https://docs.microsoft.com/windows/configuration/kiosk-shelllauncher)

![æŸ¥çœ‹æ³¨å†Œè¡¨å¯åŠ¨é¡¹](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/autoruns_logon.png)

**PowerShell** æŸ¥è¯¢ï¼š

```powershell
Get-RegistryProperties (
'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Run',
'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce',
'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx',
'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Run',
'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnce',
'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\RunOnceEx',
'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Run',
'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\RunOnce',
'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\RunOnceEx',
'HKCU\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer\Run'
) | ogv -Title 'æ³¨å†Œè¡¨å¯åŠ¨é¡¹ by anyesu'
```

#### æ¸…ç†æ®‹ç•™æ³¨å†Œè¡¨é¡¹

æ³¨å†Œè¡¨çš„æ®‹ç•™ä¸»è¦ä½äº **HKCR** ï¼ˆ **HKEY_CLASSES_ROOT** ï¼‰ä¸‹ï¼ŒåŒæ ·å¯ä»¥å€ŸåŠ© **Autoruns** å·¥å…·æŸ¥è¯¢ã€‚

![èµ„æºç®¡ç†å™¨æ®‹ç•™](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/autoruns_explorer.png)

**ç†è®ºä¸Šï¼Œæš´åŠ›åˆ æ–‡ä»¶å¯ä»¥ä½¿æ³¨å†Œè¡¨é¡¹å¤±æ•ˆï¼Œæ‰€ä»¥å¯¹æ³¨å†Œè¡¨ä¸€çªä¸é€šçš„è¯å¯ä»¥è·³è¿‡æ­¤æ­¥éª¤ï¼Œé¿å…è¯¯æ“ä½œå¯¼è‡´ç³»ç»Ÿå´©æºƒã€‚**

> **HKCR** æ˜¯ä¸‹é¢ä¸¤è€…çš„åˆå¹¶è§†å›¾ï¼Œ **HKCU** ä¸­çš„é…ç½®å…·æœ‰æ›´é«˜ä¼˜å…ˆçº§ï¼ˆ å¦‚æœå­˜åœ¨ ï¼‰ï¼Œå¯¹ **HKCR** çš„ä¿®æ”¹ä¼˜å…ˆä½œç”¨äº **HKCU** ä¸­ï¼ˆ å¦‚æœå­˜åœ¨ ï¼‰ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœä¸¤å¤„éƒ½å­˜åœ¨ä¸€ä¸ªé¡¹åˆ™éœ€è¦åœ¨ **HKCR** ä¸­åˆ é™¤ä¸¤æ¬¡ã€‚ï¼ˆ [å‚è€ƒ](https://docs.microsoft.com/windows/win32/sysinfo/hkey-classes-root-key) ï¼‰
>
> ```ini
> HKCU\SOFTWARE\Classes\*
> HKLM\SOFTWARE\Classes\*
> ```

##### èµ„æºç®¡ç†å™¨å³é”®èœå•

- [Shell](https://docs.microsoft.com/windows/win32/shell/fa-verbs)

  ä¸€èˆ¬å¸¸ç”¨çš„æ–¹å¼ï¼Œç»™èœå•èµ‹å€¼ä¸€ä¸²å‘½ä»¤å³å¯ï¼Œæ¯”è¾ƒç®€å•ã€‚

  æ³¨å†Œè¡¨ç»“æ„ï¼š

  ```ini
  HKEY_CLASSES_ROOT
     MyProgram.exe
        shell
           open
              command
                 (Default) = C:\MyDir\MyProgram.exe /a "%1"
  ```

  - [åˆ›å»ºå¿«æ·èœå•](https://docs.microsoft.com/windows/win32/shell/context-menu-handlers)
  - [Add Ribbon Command to Context Menu in Windows 10](https://winaero.com/ribbon-command-context-menu-windows-10)
  - [æ„ŸçŸ¥ç±»å‹](https://docs.microsoft.com/windows/win32/shell/fa-perceivedtypes)

- [Shell Extensions](https://docs.microsoft.com/windows/win32/shell/shell-exts)

  **Shell** çš„æ‰©å±•ï¼Œé€šè¿‡ç¼–ç¨‹æ–¹å¼ï¼ˆ [DLL](https://filext.com/file-extension/DLL) ã€ [OCX](https://filext.com/file-extension/OCX) ï¼‰æä¾›å¤æ‚çš„èœå•æ•ˆæœã€‚

  - [æ³¨å†Œ Shell æ‰©å±•å¤„ç†ç¨‹åº](https://docs.microsoft.com/windows/win32/shell/reg-shell-exts)

  æ³¨å†Œè¡¨ç»“æ„ï¼š

  ```ini
  HKEY_CLASSES_ROOT
     *
        shellex
           ContextMenuHandlers
              MyCommand
                 (Default) = {00021500-0000-0000-C000-000000000046}
     CLSID
        {00021500-0000-0000-C000-000000000046}
           InprocServer32
              (Default) = %windir%\System32\Example.dll
              ThreadingModel = Apartment
  HKEY_LOCAL_MACHINE
     Software
        Microsoft
           Windows
              CurrentVersion
                 Shell Extensions
                    Approved
                    {00021500-0000-0000-C000-000000000046} = MyCommand
  ```

  ```ini
  HKEY_CLASSES_ROOT
     .myp
        (Default) = MyProgram.1
     CLSID
        {11111111-2222-3333-4444-555555555555}
           InProcServer32
              (Default) = C:\MyDir\MyPropSheet.dll
              ThreadingModel = Apartment
     MyProgram.1
        (Default) = MyProgram Application
        Shellex
           PropertySheetHandlers
              MyPropSheet
                 (Default) = {11111111-2222-3333-4444-555555555555}
  ```

  å€ŸåŠ© **FILExt** åˆ†æ **52 å¥½å‹** æ‰©å±•æ–‡ä»¶ `k52zip\kzip_ext64.dll` çš„æ³¨å†Œè¡¨é…ç½®ï¼Œå’Œå®é™…çš„æ³¨å†Œè¡¨å†…å®¹å¯ä»¥å¯¹ä¸Šï¼š

  ```ini
  HKCR
  {
     NoRemove CLSID
     {
        ForceRemove s '%UUID_SHELL_MENU%' = s 'k52zip shell menu'
        {
           InprocServer32 = s '%MODULE%'
           {
              val ThreadingModel = s 'Apartment'
           }
        }
     }

     NoRemove *
     {
        NoRemove ShellEx
        {
           NoRemove ContextMenuHandlers
           {
              ForceRemove kzipext = s '%UUID_SHELL_MENU%'
           }
        }
     }

     NoRemove Directory
     {
        NoRemove ShellEx
        {
           NoRemove ContextMenuHandlers
           {
              ForceRemove kzipext = s '%UUID_SHELL_MENU%'
           }
        }
     }
  }
  ```

ä»ä¸Šé¢çš„å†…å®¹å¯ä»¥çœ‹å‡ºé€šå¸¸ **DLL** ä¼šæ³¨å†Œå¤šä¸ªèœå•ä»¥åŠå¤šç§ç±»å‹çš„æ³¨å†Œè¡¨é¡¹ï¼Œæ‰‹åŠ¨åˆ é™¤æ³¨å†Œè¡¨é¡¹å¾ˆå®¹æ˜“æ¼åˆ å’Œè¯¯åˆ ï¼Œ **æ­£ç¡®çš„åŠæ³•æ˜¯æ‰¾åˆ°å¯¹åº”çš„ DLL è¿›è¡Œåæ³¨å†Œ** ï¼ˆ ä¼šè‡ªåŠ¨åˆ é™¤ç›¸å…³çš„æ³¨å†Œè¡¨å†…å®¹ï¼Œåæ³¨å†Œæ–¹æ³•è§ [å·¥å…·æ±‡æ€»](#å·¥å…·æ±‡æ€») ï¼‰ã€‚

![èµ„æºç®¡ç†å™¨ - å³é”®èœå•ç®¡ç†](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/contextmenumanager.png)

å¯ä»¥å€ŸåŠ© **ContextMenuManager** ç®¡ç†å³é”®èœå•ã€‚ä¸å€ŸåŠ©å·¥å…·çš„è¯æ¯”è¾ƒéº»çƒ¦ï¼Œå¯ä»¥é€šè¿‡ä¸‹é¢çš„ **PowerShell** è„šæœ¬æ¥æŸ¥è¯¢ï¼š

```powershell
function Get-RegistryShellTypes {
    $Types = '* AllFileSystemObjects Folder Directory Directory\Background DesktopBackground Drive Network NetShare NetServer Printers AudioCD DVD'.Split(' ')
    $Types += 'UserLibraryFolder lnkfile exefile Unknown'.Split(' ')
    # æ­¤ç”µè„‘
    $Types += 'CLSID\{20D04FE0-3AEA-1069-A2D8-08002B30309D}'
    # å›æ”¶ç«™
    $Types += 'CLSID\{645FF040-5081-101B-9F08-00AA002F954E}'
    # æ„ŸçŸ¥ç±»å‹
    $Types += 'text document image video audio Compressed system'.Split(' ') |
        % { "SystemFileAssociations\$($_)" }
    $Types
}

function Get-Results {
    $Results = @()
    $Default = @{n="Default";e={ Get-RegistryDefault $_.Name }}
    $Type1 = @{n="Type";e={ "å³é”®èœå•" }}
    $Type2 = @{n="Type";e={ "å³é”®æ‰©å±•" }}
    $Type3 = @{n="Type";e={ "å…¬å…±å¼•ç”¨" }}
    $Detail1 = @{n="Detail";e={ Get-RegistryDefault "$($_.Name)\Command" }}
    $Detail2 = @{n="Detail";e={ Get-RegistryRefDll $_.Default }}
    foreach ($Type in Get-RegistryShellTypes) {
        $Results += (Get-RegistryChildItem "HKCR\$Type\shell" |
            select Name, $Type1, $Default, $Detail1
        )
        $Results += [pscustomobject]@{}

        $a = [string[]](Get-RegistryChildItem "HKCR\$Type\shellex").Name
        if ($a.Length -eq 0) { continue }
        $Results += (Get-RegistryChildItem $a | select Name, $Default |
            select Name, $Type2, Default, $Detail2
        )
        $Results += [pscustomobject]@{}
    }

    $Results += [pscustomobject]@{}
    # å…¬å…±å¼•ç”¨ï¼Œç”¨äºåˆ›å»º SubCommands
    $Results += (ls "HKLM:\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\CommandStore\shell" -Exclude Windows* |
        select Name, $Type3, $Default, $Detail1
    )
    $Results
}
$Results = (Get-Results)
$Results | ogv -Title 'èµ„æºç®¡ç†å™¨ - å³é”®åŠ è½½é¡¹ by anyesu'
```

![èµ„æºç®¡ç†å™¨ - å³é”®åŠ è½½é¡¹](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/explorer_shell.png)

æœ¬æ¥å†™äº†ä¸ªæ‰¹å¤„ç†ï¼Œåˆè‡­åˆé•¿é€Ÿåº¦è¿˜æ…¢ï¼Œä¼˜åŒ–ä¸åŠ¨äº†ã€‚æ„å¤–å‘ç° **PowerShell** æ¥å®ç°æ•ˆæœæ›´å¥½ï¼Œä¸ä»…é€Ÿåº¦å¿«è¿˜æ”¯æŒè¡¨æ ¼å±•ç¤ºï¼ˆ é€‰ä¸­è¡Œå `Ctrl + C` å¯å¤åˆ¶æ•´è¡Œå†…å®¹ ï¼‰å’Œæ’åºæ£€ç´¢ï¼Œå°±æ˜¯åˆšå¼€å§‹æ¥è§¦ï¼Œ [è¯­æ³•](https://docs.microsoft.com/powershell/scripting/learn/ps101/01-getting-started) ä¸ç†Ÿæ‚‰å†™å¾—æœ‰ç‚¹åˆ«æ‰­ï¼Œå‡‘åˆç€ç”¨ã€‚

ä¹Ÿå¯ä»¥å¯¼å‡ºä¸º **CSV** æ–‡ä»¶ï¼Œé€šè¿‡æ¯”è¾ƒå‰åçš„æ–‡ä»¶å¯ä»¥å¿«é€Ÿç­›é€‰å‡ºæ–°å¢çš„é¡¹ç›®ã€‚

```powershell
$Results | epcsv -Encoding utf8 results.csv
```

##### [æ–°å»ºèœå•](https://docs.microsoft.com/windows/win32/shell/context#extending-the-new-submenu)

![èµ„æºç®¡ç†å™¨ - æ–°å»ºèœå•](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/shell_new.png)

æ³¨å†Œè¡¨ç»“æ„ï¼š

```ini
HKEY_CLASSES_ROOT
   .myp
      (Default) = MyProgram.1
      MyProgram.1
         ShellNew
            NullFile
```

æ‰¹å¤„ç†ç®€å•æŸ¥è¯¢ï¼š

```powershell
:: HKCR\{.type}\ShellNew
reg query HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Discardable\PostSetup\ShellNew /v Classes
```

**PowerShell** æŸ¥è¯¢ï¼š

```powershell
Get-RegistryValue HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Discardable\PostSetup\ShellNew Classes |
    % { echo "HKCR\$($_)\ShellNew" }
```

ä¸éœ€è¦çš„æ–‡ä»¶ç±»å‹åˆ é™¤å¯¹åº”çš„ **ShellNew** é¡¹ï¼ˆ æ¯”å¦‚ `HKCR\.bmp\ShellNew` ï¼‰å³å¯ã€‚è€Œ **Classes** å€¼çš„æ•°æ®ç”¨äºæ§åˆ¶æ˜¾ç¤ºé¡ºåºï¼Œæ¯æ¬¡æ˜¾ç¤ºå³é”®èœå•æ—¶è‡ªåŠ¨æ›´æ–°ï¼ˆ [å¯ä¿®æ”¹æƒé™æ¥å›ºå®šå†…å®¹](https://www.jianshu.com/p/8af973904347) ï¼‰ï¼Œä¸ç”¨æ‰‹åŠ¨æ”¹ã€‚

##### ShellExecuteHooks

```ini
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellExecuteHooks
HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\ShellExecuteHooks
```

**PowerShell** æŸ¥è¯¢ï¼š

```powershell
Get-RegistryProperties (
'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellExecuteHooks',
'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\ShellExecuteHooks'
) | select Key, @{l="Dll";e={ Get-RegistryRefDll $_.Name }} |
ogv -Title 'èµ„æºç®¡ç†å™¨ - ShellExecuteHooks by anyesu'
```

##### [é¢„è§ˆ](https://docs.microsoft.com/windows/win32/shell/preview-handlers)

> [PowerToys](https://github.com/microsoft/PowerToys)

æ³¨å†Œè¡¨ç»“æ„ï¼š

```ini
HKEY_CLASSES_ROOT
   xyzfile
      shellex
         {8895b1c6-b41f-4c1c-a562-0d564250836f}
            (Default) = [REG_SZ] {ec3a629a-a47c-4245-bc78-b4b63d0e3154}
HKEY_CLASSES_ROOT
   CLSID
      {ec3a629a-a47c-4245-bc78-b4b63d0e3154}
         (Default) = [REG_SZ] Fabricam XYZ Preview Handler
         DisplayName = [REG_SZ] @myhandler.dll,-101
         Icon = [REG_SZ] myhandler.dll,201
         AppID = [REG_SZ] {6d2b5079-2f0b-48dd-ab7f-97cec514d30b}
         InprocServer32
            (Default) = [REG_EXPAND_SZ] %ProgramFiles%\Fabricam\myhandler.dll
            ThreadingModel = [REG_SZ] Apartment
            ProgID = [REG_SZ] xyzfile
            VersionIndependentProgID = [REG_SZ] Version IndependentProgID
HKEY_LOCAL_MACHINE or HKEY_CURRENT_USER
   SOFTWARE
      Microsoft
         Windows
            CurrentVersion
               PreviewHandlers
                  {ec3a629a-a47c-4245-bc78-b4b63d0e3154}
                     (Default) = [REG_SZ] Fabricam XYZ Preview Handler
```

**PowerShell** æŸ¥è¯¢ï¼š

```powershell
Get-RegistryProperties (
'HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\PreviewHandlers',
'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\PreviewHandlers'
) | select *, @{l="Dll";e={ Get-RegistryRefDll $_.Name }} |
ogv -Title 'èµ„æºç®¡ç†å™¨ - é¢„è§ˆ by anyesu'
```

##### [ä»»åŠ¡æ  - å·¥å…·æ ](https://github.com/Planet-Source-Code/rob-parsons-how-to-add-the-google-toobar-to-the-windows-taskbar__1-46033)

> [XMeters](https://entropy6.com/xmeters)

æ³¨å†Œè¡¨ç»“æ„ï¼š

```ini
HKEY_CLASSES_ROOT\CLSID\{Toolbar GUID}
   (Default) = Toolbar Name
   Implemented Categories
      {00021492-0000-0000-C000-000000000046}
```

å…¶ä¸­ `Implemented Categories` æŒ‡æ˜äº†ç±»å‹ä¸º `Desk Band` ï¼š

```ini
HKEY_CLASSES_ROOT\Component Categories\{00021492-0000-0000-C000-000000000046}
   409 = Desk Band
```

å€ŸåŠ© **FILExt** åˆ†æ **52 å¥½å‹** æ‰©å±•æ–‡ä»¶ `k52zip\kzip_ext64.dll` çš„æ³¨å†Œè¡¨é…ç½®ï¼š

```ini
HKCR
{
   NoRemove CLSID
   {
      ForceRemove s '%UUID_SHELL_BAND%' = s 'k52zip shell band'
      {
         InprocServer32 = s '%MODULE%'
         {
            val ThreadingModel = s 'Apartment'
         }
      }
   }
}
```

æ‰¹å¤„ç†ç®€å•æŸ¥è¯¢ï¼š

```powershell
for /f "usebackq tokens=1-3 delims=\" %i in (`reg query HKCR\CLSID /f {00021492-0000-0000-C000-000000000046} /k /s 2^>nul^| findstr HKEY`) do @reg query "%i\%j\%k\InProcServer32" /ve 2>nul
```

åæ³¨å†Œ **DLL** åè®°å¾—å…³é—­å·²å¯ç”¨çš„å·¥å…·æ æˆ–è€…ç›´æ¥é‡å¯èµ„æºç®¡ç†å™¨ã€‚

![åˆ é™¤å·¥å…·æ ](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/delete_toolbar.png)

##### [IE æ’ä»¶](<https://docs.microsoft.com/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753587(v=vs.85)>)

**IE** ç°åœ¨å¾ˆå°‘ç”¨äº†ï¼Œå¯ä»¥å…¨éƒ¨åˆ æ‰ã€‚ï¼ˆ ä¿®æ”¹åé‡å¯ **IE** ç”Ÿæ•ˆ ï¼‰

- [BHO æ’ä»¶](https://en.wikipedia.org/wiki/Browser_Helper_Object)

  > **Internet** é€‰é¡¹ > ç¨‹åº > ç®¡ç†åŠ è½½é¡¹ > å³é”®æ’ä»¶ > è¯¦ç»†ä¿¡æ¯ > å®šä½åˆ° **DLL** æ–‡ä»¶è¿›è¡Œåæ³¨å†Œ

  ```ini
  # BHO åˆ é™¤æ­¤é¡¹å³å¯
  HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects\{GUID}
  HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\Browser Helper Objects\{GUID}

  # lib
  HKCR\CLSID\{GUID}

  # è®¾ç½®é¡¹
  HKCU\SOFTWARE\Microsoft\Internet Explorer\Approved Extensions
  HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Ext\Settings\{GUID}
  HKCU\SOFTWARE\Microsoft\Windows\CurrentVersion\Ext\Stats\{GUID}
  ```

- [æ ‡å‡†ä¸Šä¸‹æ–‡èœå•](<https://docs.microsoft.com/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753589(v=vs.85)>)

  æ‰§è¡Œç”± **URL** æŒ‡å®šçš„è„šæœ¬ã€‚

  ```ini
  HKCU\SOFTWARE\Microsoft\Internet Explorer\MenuExt\<Menu Text>
  ```

- [å·¥å…·æˆ–å¸®åŠ©çš„èœå•é¡¹](<https://docs.microsoft.com/previous-versions/windows/internet-explorer/ie-developer/platform-apis/aa753591(v=vs.85)>)

  è¿è¡Œåº”ç”¨ç¨‹åºæˆ–è„šæœ¬ã€‚

  ```ini
  HKCU\SOFTWARE\Microsoft\Internet Explorer\Extensions\{GUID}
  HKLM\SOFTWARE\Microsoft\Internet Explorer\Extensions\{GUID}
  ```

##### å›¾æ ‡

ä½¿ç”¨ [ie4uinit](https://www.file.net/process/ie4uinit.exe.html) ä¸é‡å¯èµ„æºç®¡ç†å™¨åˆ·æ–°æ–‡ä»¶å›¾æ ‡ï¼ˆ [å‚è€ƒ](https://www.cnblogs.com/prograys/p/14148644.html) ï¼‰ï¼š

```powershell
:: win10 ( æµ‹è¯•äº† win7 å‘ç°ä¹Ÿèƒ½ç”¨è¿™ä¸ª )
ie4uinit -show

:: win10 ä¹‹å‰çš„ç³»ç»Ÿ
ie4uinit -ClearIconCache
```

- [è‡ªå®šä¹‰å›¾æ ‡åˆ†é…ç»™æ–‡ä»¶ç±»å‹](https://docs.microsoft.com/windows/win32/shell/how-to-assign-a-custom-icon-to-a-file-type)

  æ³¨å†Œè¡¨ç»“æ„ï¼š

  ```ini
  HKEY_CLASSES_ROOT
     .myp
        (Default) = MyProgram.1
        DefaultIcon
           (Default) = C:\MyDir\MyProgram.exe,2

  HKEY_CLASSES_ROOT
     .myp
        (Default) = MyProgram.1
     MyProgram.1
        DefaultIcon
           (Default) = C:\MyDir\MyProgram.exe,2
  ```

- [å›¾æ ‡è¦†ç›–](https://docs.microsoft.com/windows/win32/shell/how-to-register-icon-overlay-handlers)

  ```ini
  HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers
  HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers
  ```

  æ¯”å¦‚å®‰è£… **Tortoise(GIT/SVN)** åå¯ä»¥çœ‹åˆ°é¡¹ç›®æ–‡ä»¶å›¾æ ‡ä¼šå¤šå‡ºåŒæ­¥çŠ¶æ€çš„è§’æ ‡ï¼Œå°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼å®ç°çš„ã€‚è¦†ç›–é¡ºåºä¸ºæ³¨å†Œè¡¨ä¸­çš„æ˜¾ç¤ºé¡ºåºï¼Œæœ€å‰é¢çš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œå¹¶ä¸”åªæœ‰å‰ 15 ä¸ªï¼ˆ ç³»ç»Ÿå›ºå®šå ç”¨ 4 ä¸ª ï¼‰æœ‰æ•ˆï¼Œ **é€šå¸¸åœ¨é¡¹åç§°å‰åŠ ç©ºæ ¼ä»¥æå‡ä¼˜å…ˆçº§** ã€‚

  - [Why does Windows limit icon overlays to 15?](https://superuser.com/q/1166577)
  - [Registered icon overlay handlers aren't used by Windows Shell](https://docs.microsoft.com/troubleshoot/windows/win32/icon-overlay-handlers-windows-shell)
  - [What are those little overlay icons: Windows 7 edition](https://devblogs.microsoft.com/oldnewthing/20091209-00/?p=15723)
  - [Why is there a limit of 15 shell icon overlays?](https://devblogs.microsoft.com/oldnewthing/20190313-00/?p=101094)

  å€ŸåŠ© **FILExt** åˆ†æ **é£å‹** æ‰©å±•æ–‡ä»¶ `FeiRar\FeiRarHelp64.dll` çš„æ³¨å†Œè¡¨é…ç½®ï¼š

  ```ini
  HKCR
  {
     NoRemove CLSID
     {
        ForceRemove {937C4FD2-3242-4E1A-B7DF-27437B67B620} = s 'FeiRarShlExt Class'
        {
           ForceRemove Programmable
           InprocServer32 = s '%MODULE%'
           {
              val ThreadingModel = s 'Apartment'
           }
           TypeLib = s '{2920F6F2-E1D0-48C2-B202-555CA4900C7D}'
           Version = s '1.0'
        }
     }
  }
  HKLM
  {
     NoRemove SOFTWARE
     {
        NoRemove Microsoft
        {
           NoRemove Windows
           {
              NoRemove CurrentVersion
              {
                 NoRemove Explorer
                 {
                    NoRemove ShellIconOverlayIdentifiers
                    {
                       ForceRemove CFeiRarShlExt = s '{937C4FD2-3242-4E1A-B7DF-27437B67B620}'
                    }
                 }
              }
           }
        }
     }
  }
  ```

  æ‰¹å¤„ç†ç®€å•æŸ¥è¯¢ï¼š

  ```ini
  for /f "usebackq tokens=1,2* delims= " %i in (`reg query "HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers" /s 2^>nul`) do @if "%k" == "" (echo; && echo åŠ è½½é¡¹ï¼š "%i %j") else (reg query "HKCR\CLSID\%k\InprocServer32" /ve 2>nul)
  ```

  **PowerShell** æŸ¥è¯¢ï¼š

  ```powershell
  Get-RegistryChildItem (
  'HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers',
  'HKLM\SOFTWARE\WOW6432Node\Microsoft\Windows\CurrentVersion\Explorer\ShellIconOverlayIdentifiers'
  ) | select Name, @{n="Detail";e={ Get-RegistryRefDll (Get-RegistryDefault $_.Name) }} |
  ogv -Title 'èµ„æºç®¡ç†å™¨ - å›¾æ ‡è¦†ç›– by anyesu'
  ```

##### [æ§åˆ¶é¢æ¿é™„åŠ é¡¹](https://docs.microsoft.com/windows/win32/shell/how-to-register-an-executable-control-panel-item-registration-)

```ini
HKLM\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\ControlPanel\NameSpace\{GUID}
```

ä¸€èˆ¬é™¤äº†å¸è½½ç±»è½¯ä»¶ï¼ˆ **IObit Uninstaller** ï¼‰å¾ˆå°‘é‡åˆ°åŠ¨æ§åˆ¶é¢æ¿çš„ï¼Œå°±ä¸éœ€è¦ç®¡äº†ã€‚

##### å…¶ä»–æ³¨å†Œè¡¨æ®‹ç•™

ä¸Šé¢åªæ˜¯æ¸…é™¤ä¸€äº›å¸¸è§çš„æ³¨å†Œè¡¨é¡¹ï¼Œåº”è¯¥è¿˜ä¼šå‰©ä½™ä¸€äº›æ®‹ç•™ï¼ˆ æ¯”å¦‚é©±åŠ¨ã€æ–‡ä»¶ç±»å‹å…³è”ã€é˜²ç«å¢™ç­‰ ï¼‰ï¼Œä¸€èˆ¬ä¸æ¸…ç†é—®é¢˜ä¹Ÿä¸å¤§ï¼Œåªæ˜¯ç¨å¾®å ç‚¹ç©ºé—´è€Œå·²ï¼Œåˆ é”™äº†åè€Œå®¹æ˜“å‡ºé—®é¢˜ã€‚ç­‰ä¹‹åæºæ–‡ä»¶éƒ½åˆ å¹²å‡€äº†ï¼Œå¯ä»¥ç”¨æ³¨å†Œè¡¨æ¸…ç†å·¥å…·æˆ–æ€æ¯’è½¯ä»¶æ‰«æä¸‹ï¼Œä¸€èˆ¬éƒ½èƒ½æ£€æµ‹å‡ºæ®‹ç•™çš„æ— æ•ˆæ³¨å†Œè¡¨ï¼ŒæŒ‰éœ€æ¸…ç†ã€‚æ¯”å¦‚ç”¨è½¯åª’æ¸…ç†å¤§å¸ˆï¼ˆ **Windows 7** å…¼å®¹æ¨¡å¼æ‰“å¼€ ï¼‰æ¸…ç†é”™è¯¯çš„æ–‡ä»¶å…³è”ã€‚

![è½¯åª’æ¸…ç†å¤§å¸ˆ - æ³¨å†Œè¡¨æ¸…ç†](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/cleanmaster.png)

#### åˆ é™¤æ®‹ç•™æ–‡ä»¶

**å‚è€ƒï¼š [ã€C ç›˜å¨˜ã€‘æµæ°“è½¯ä»¶çº¯æ‰‹åŠ¨æš´åŠ›å¼å½»åº•æ¸…ç†å¸è½½ï¼Œå‘Šåˆ«å¼¹çª—å¹¿å‘Š](https://zhuanlan.zhihu.com/p/443898850)**

> **SoftCnKiller** çš„ä½œè€…æœ‰ä¸€ä¸ª [è§†é¢‘](https://www.bilibili.com/video/av627360944) ä¸­ä»‹ç»äº†ç”¨å‘½ä»¤è¡Œã€ [Windows RE](https://docs.microsoft.com/windows-hardware/manufacture/desktop/windows-recovery-environment--windows-re--technical-reference) ã€ **PE** åŠå„ç§å·¥å…·åˆ é™¤æ–‡ä»¶çš„æ–¹æ³•ï¼Œä¸æ‡‚çš„è¯çœ‹ç€å¯èƒ½ä¼šæ¯”è¾ƒæ‡µã€‚

**ä¸æ‡‚çš„è¯ä¸ç”¨ç®¡ç³»ç»Ÿç›®å½•ï¼ˆ `%windir%\System32` å’Œ `%windir%\SysWOW64` ï¼‰ä¸­çš„æ–‡ä»¶ï¼Œä¸€èˆ¬ä¸æ¸…ç†æ²¡ä»€ä¹ˆå½±å“ã€‚**

##### å®‰è£…ç›®å½•

åŒ…å«ç¨‹åºçš„æ ¸å¿ƒæ–‡ä»¶ï¼Œåˆ é™¤å¯èƒ½å¯¼è‡´å…¶æ— æ³•æ­£å¸¸è¿è¡Œã€‚

| è¯´æ˜               | ç¯å¢ƒå˜é‡                  | å®é™…è·¯å¾„                            |
| ------------------ | ------------------------- | ----------------------------------- |
| ç¨‹åºå®‰è£…ç›®å½• 64 ä½ | %ProgramFiles%            | C:\Program Files                    |
| ç¨‹åºå®‰è£…ç›®å½• 32 ä½ | %ProgramFiles(x86)%       | C:\Program Files (x86)              |
| å…¬ç”¨æ–‡ä»¶å¤¹ 64 ä½   | %CommonProgramFiles%      | C:\Program Files\Common Files       |
| å…¬ç”¨æ–‡ä»¶å¤¹ 32 ä½   | %CommonProgramFiles(x86)% | C:\Program Files (x86)\Common Files |

- **Common Files** ç›®å½•åº”è¯¥æ˜¯ç”¨äºå¤šä¸ªè½¯ä»¶ä¹‹é—´å…±äº«æ–‡ä»¶çš„ï¼Œä¸è¿‡å¾ˆå°‘æœ‰ç”¨åˆ°ã€‚

- æœ‰äº›æµæ°“è½¯ä»¶è¿˜ä¼šé€‰æ‹©å®‰è£…åˆ° **%APPDATA%** ç›®å½•ä¸‹ã€‚

##### ç¨‹åºæ•°æ®

å¸¸ç”¨æ¥å­˜æ”¾ç¨‹åºè¿è¡Œæ—¶äº§ç”Ÿçš„é…ç½®æ–‡ä»¶å’Œæ•°æ®ã€‚

| è¯´æ˜                | ç¯å¢ƒå˜é‡                                       | å®é™…è·¯å¾„                                         |
| ------------------- | ---------------------------------------------- | ------------------------------------------------ |
| "æ‰€æœ‰ç”¨æˆ·" é…ç½®æ–‡ä»¶ | %ALLUSERSPROFILE%                              | C:\ProgramData                                   |
| æœ¬åœ°ç¨‹åºæ•°æ®        | %ProgramData%                                  | C:\ProgramData                                   |
| ç”¨æˆ·ç¨‹åºæ•°æ®æ¼«æ¸¸    | %APPDATA%                                      | C:\Users\test\AppData\Roaming                    |
| ç”¨æˆ·ç¨‹åºæ•°æ®æœ¬åœ°    | %LOCALAPPDATA%                                 | C:\Users\test\AppData\Local                      |
| ç³»ç»Ÿ APPDATA 32 ä½  | %windir%\System32\config\systemprofile\AppData | C:\Windows\System32\config\systemprofile\AppData |
| ç³»ç»Ÿ APPDATA 64 ä½  | %windir%\SysWOW64\config\systemprofile\AppData | C:\Windows\SysWOW64\config\systemprofile\AppData |

- ç³»ç»Ÿæ˜¯å…è®¸å¤šç”¨æˆ·æ“ä½œçš„ï¼Œå› æ­¤ **ProgramData** å’Œ **AppData** åˆ†åˆ«ç”¨äºä¿å­˜ç”¨æˆ·é—´å…±äº«å’Œç‹¬äº«çš„é…ç½®æ–‡ä»¶å’Œæ•°æ®ã€‚

- [**ALLUSERSPROFILE** ä¸ **ProgramData** çš„åŒºåˆ«](https://stackoverflow.com/q/37269376)

- [**Local** ã€ **LocalLow** å’Œ **Roaming** ä¹‹é—´çš„åŒºåˆ«](https://www.howtogeek.com/318177/what-is-the-appdata-folder-in-windows)

  ![AppData é»˜è®¤æ–‡ä»¶](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/explorer_appdata.png)

  éƒ½æ˜¯ç”¨æ¥å­˜æ”¾ç”¨æˆ·é…ç½®æ–‡ä»¶æˆ–ä¸´æ—¶æ–‡ä»¶çš„ï¼ŒåŒºåˆ«åº”è¯¥åœ¨äºæ˜¯å¦éœ€è¦åœ¨ç½‘ç»œä¸Šå…±äº«ï¼ˆ æ¼«æ¸¸ ï¼‰ï¼Œå¹³æ—¶æ²¡ä»€ä¹ˆä½“ä¼šï¼Œä¸è¿‡çœ‹å¾ˆå¤šè½¯ä»¶è²Œä¼¼éƒ½åœ¨éšä¾¿ä¹±ç”¨ã€‚

  **%APPDATA%** ç›®å½•åˆå§‹åªåŒ…å« **Adobe** å’Œ **Microsoft** ä¸¤ä¸ªæ–‡ä»¶å¤¹ï¼Œå…¶ä»–ç›®å½•ï¼ˆ é™¤äº†æµè§ˆå™¨å’Œ **IDE** çš„é…ç½® ï¼‰éƒ½å¯ä»¥åˆ é™¤ã€‚

- **ç³»ç»Ÿ APPDATA** æ˜¯ **ç³»ç»Ÿå¸æˆ·** çš„ç”¨æˆ·é…ç½®ç›®å½•ï¼ˆ [å‚è€ƒ](https://superuser.com/a/598626) ï¼‰ï¼Œç›®å½•éœ€è¦ä¸€çº§ä¸€çº§è¿›å»ã€‚

  ä¸€èˆ¬æ€æ¯’è½¯ä»¶ä¸€ç±»çš„è¿›ç¨‹æ˜¯ä»¥ **ç³»ç»Ÿå¸æˆ·** è¿è¡Œçš„ï¼Œæ¯”å¦‚è…¾è®¯ç”µè„‘ç®¡å®¶ã€‚

- æœ‰äº›æ¶å¿ƒçš„è½¯ä»¶å¯èƒ½ä¼šåœ¨ **%LOCALAPPDATA%\Packages** ç›®å½•ä¸‹å­˜æ”¾æ•°æ®ã€‚

##### ç”¨æˆ·ç›®å½•

å­˜æ”¾ç”¨æˆ·ç›¸å…³çš„æ•°æ®ã€‚

| è¯´æ˜         | ç¯å¢ƒå˜é‡                                           | å®é™…è·¯å¾„                                                               |
| ------------ | -------------------------------------------------- | ---------------------------------------------------------------------- |
| å…¬å…±ç”¨æˆ·     | %PUBLIC%                                           | C:\Users\Public                                                        |
| ç”¨æˆ·ç›®å½•     | %USERPROFILE%                                      | C:\Users\test                                                          |
| æ¡Œé¢         | %USERPROFILE%\Desktop                              | C:\Users\test\Desktop                                                  |
| æˆ‘çš„æ–‡æ¡£     | %USERPROFILE%\Documents                            | C:\Users\test\Documents                                                |
| æ”¶è—å¤¹       | %USERPROFILE%\Favorites\Links                      | C:\Users\test\Favorites\Links                                          |
| å¿«é€Ÿå¯åŠ¨     | %APPDATA%\Microsoft\Internet Explorer\Quick Launch | C:\Users\test\AppData\Roaming\Microsoft\Internet Explorer\Quick Launch |
| ç”¨æˆ·å¼€å§‹èœå• | %APPDATA%\Microsoft\Windows\Start Menu             | C:\Users\test\AppData\Roaming\Microsoft\Windows\Start Menu             |
| å…¬ç”¨å¼€å§‹èœå• | %ProgramData%\Microsoft\Windows\Start Menu         | C:\ProgramData\Microsoft\Windows\Start Menu                            |
| å­—ä½“ç›®å½•     | %windir%\Fonts                                     | C:\Windows\Fonts                                                       |
| è¾“å…¥æ³•ç›®å½•   | %windir%\IME                                       | C:\Windows\IME                                                         |

- **PUBLIC** æ˜¯ä¸ºäº†åœ¨å¤šç”¨æˆ·é—´å…±äº«æ•°æ®ï¼Œæ¯”å¦‚å¾ˆå¤šè½¯ä»¶å–œæ¬¢æŠŠå¿«æ·æ–¹å¼æ”¾åˆ°å…¬å…±æ¡Œé¢ä¸‹ã€‚

##### ä¸´æ—¶æ–‡ä»¶

å¯ä»¥å…¨éƒ¨åˆ é™¤ï¼Œå¯ä»¥ç”¨è½¯åª’æ¸…ç†å¤§å¸ˆä¸€é”®æ¸…ç†ã€‚

| è¯´æ˜           | ç¯å¢ƒå˜é‡                           | å®é™…è·¯å¾„                                               |
| -------------- | ---------------------------------- | ------------------------------------------------------ |
| ç³»ç»Ÿä¸´æ—¶æ–‡ä»¶   | %SystemRoot%\TEMP                  | C:\Windows\Temp                                        |
| ç”¨æˆ·ä¸´æ—¶æ–‡ä»¶   | %TEMP% å’Œ %TMP%                    | C:\Users\test\AppData\Local\Temp                       |
| æœ€è¿‘ä½¿ç”¨çš„é¡¹ç›® | %APPDATA%\Microsoft\Windows\Recent | C:\Users\test\AppData\Roaming\Microsoft\Windows\Recent |

##### æ“ä½œæ­¥éª¤

æˆ‘ä»¬è¦åšçš„å°±æ˜¯ä¾æ¬¡æ‰“å¼€è¿™äº›ç›®å½•æ’æŸ¥é‡Œé¢çš„å­ç›®å½•ï¼š

- æŒ‰åˆ›å»ºæ—¥æœŸï¼ˆ **å¯ä»¥é€ å‡** ï¼‰å€’åºï¼Œä¸€èˆ¬æµæ°“è½¯ä»¶çš„æ–‡ä»¶ä¼šæ–°ä¸€ç‚¹ã€‚

  > å³é”®æ ‡é¢˜æ  > å…¶ä»– > å‹¾é€‰å…¬å¸ï¼Œæ ¹æ®å…¬å¸åå¾ˆå®¹æ˜“åŒºåˆ†æ˜¯ä¸æ˜¯ç¬¬ä¸‰æ–¹è½¯ä»¶çš„æ–‡ä»¶ã€‚

  ![æ–‡ä»¶æ’åº](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/explorer_details.png)

  **åŸºæœ¬é ç»éªŒï¼Œä¸€ä¸ªå®ç”¨çš„ç¬¨æ–¹æ³•å°±æ˜¯æ‰¾ä¸€å°ç›¸åŒç³»ç»Ÿçš„ç”µè„‘ï¼Œç›¸åŒç›®å½•ä¸€ä¸ªä¸€ä¸ªè¿›è¡Œå¯¹æ¯”ã€‚**

- å¦‚æœåŒ…å«å¸è½½ç¨‹åºï¼ˆ ä¸€èˆ¬æ˜¯ `uninsxxx.exe` ï¼‰å°±å…ˆæ‰§è¡Œä¸€ä¸‹ã€‚

  æœ‰äº›è½¯ä»¶å¾ˆé¸¡è´¼ä¸æ·»åŠ åˆ°æ³¨å†Œè¡¨ï¼Œä¸€èˆ¬äººå°±æ‰¾ä¸åˆ°å¸è½½çš„åœ°æ–¹ã€‚

  **æ³¨æ„ï¼šä¹‹å‰ç¢°åˆ°è¿‡ä¸€ä¸ªæµæ°“è½¯ä»¶ï¼ˆ å¿˜äº†æ˜¯ä»€ä¹ˆ ï¼‰æ®‹ç•™çš„å¸è½½ç¨‹åºæ‰§è¡Œçš„æ—¶å€™è¢« Windows Defender æŠ¥ç—…æ¯’äº†ï¼Œä¸æ”¾å¿ƒçš„è¯å°±æ‰‹åŠ¨åˆ å§ã€‚**

- çœ‹åˆ° **DLL** æ–‡ä»¶å°±åæ³¨å†Œï¼ˆ [å·¥å…·æ±‡æ€»](#å·¥å…·æ±‡æ€») ï¼‰ä¸€ä¸‹ï¼Œå¤±è´¥äº†ä¸è¦ç´§ã€‚

  ä¹Ÿå¯ä»¥ç”¨ä¸‹é¢çš„æ–¹æ³•æ‰¹é‡åˆ é™¤ã€‚

- **C ç›˜** åˆšè£…å®Œç³»ç»Ÿå¤§æ¦‚æ˜¯ä¸‹å›¾è¿™æ ·çš„ï¼Œå¤šå‡ºä¸€äº›ä¹±ä¸ƒå…«ç³Ÿçš„æ–‡ä»¶/æ–‡ä»¶å¤¹å¯ä»¥è€ƒè™‘åˆ é™¤ã€‚

  **ä¸æ¸…æ¥šæœ‰æ²¡æœ‰ç”¨å°±å»ç½‘ä¸Šæœä¸€ä¸‹æ–‡ä»¶åã€‚**

  ![C ç›˜é»˜è®¤æ–‡ä»¶](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/drive_c.png)

- åˆ é™¤å„ç§ä¹±ä¸ƒå…«ç³Ÿçš„å¿«æ·æ–¹å¼ï¼Œå°¤å…¶æ˜¯è¢«ç¯¡æ”¹çš„ **IE** å¿«æ·æ–¹å¼ã€‚

  ![ç½‘é¡µå¿«æ·æ–¹å¼](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/ie_lnk.png)

- åˆ é™¤æ•´ä¸ªå®‰è£…ç›®å½•ã€‚

- æ”¶å°¾åˆ©ç”¨ **Everything** æœç´¢ç”¨æˆ·ç›®å½•ä¸‹æ®‹ç•™çš„æ–‡ä»¶ã€‚

  ```ini
  *unins*.exe
  *.lnk
  \AppData *.exe
  \AppData *.dll
  ```

##### æ–‡ä»¶å ç”¨

æ–‡ä»¶è¢«å ç”¨ä¸€èˆ¬æ˜¯èµ„æºç®¡ç†å™¨ã€å·¥å…·æ ã€è¾“å…¥æ³•ã€å­—ä½“ã€æœåŠ¡ç­‰è¿˜åœ¨è¿è¡Œï¼Œé‡å¯å°±å¯ä»¥é‡Šæ”¾å ç”¨ï¼Œæœ‰çš„æ–‡ä»¶é‡å¯åä¼šè‡ªåŠ¨åˆ é™¤ã€‚å½“ç„¶ä¸æ’é™¤æœ‰äº›æ®‹ç•™é¡¹ä¼šåœ¨é‡å¯çš„æ—¶å€™å·åœŸé‡æ¥ï¼Œå¯ä»¥ä¸é‡å¯ç›´æ¥æ ¹é™¤æºæ–‡ä»¶æ–­ç»åè·¯ã€‚æ‰¾åˆ°å ç”¨æ–‡ä»¶çš„è¿›ç¨‹ï¼ŒæŠŠå®ƒä»¬å…³é—­åå°±èƒ½åˆ é™¤äº†ï¼ŒæŸ¥æ‰¾å ç”¨çš„æ–¹æ³•ï¼š

> ä»»åŠ¡ç®¡ç†å™¨ > æ€§èƒ½ > æ‰“å¼€èµ„æºç›‘è§†å™¨ > **CPU** > æœç´¢å¥æŸ„ > å¡«å…¥å¯¹åº”çš„ç›®å½•åæˆ–æ–‡ä»¶å > ç»“æŸæ‰æœç´¢ç»“æœä¸­çš„è¿›ç¨‹ã€‚

å½“ç„¶ï¼Œç”¨ **Process Explorer** æŸ¥è¯¢æ›´å¥½ç”¨ã€‚

**é‡åˆ°æƒé™é—®é¢˜æˆ–è€…å…¶ä»–é—®é¢˜æ€ä¹ˆåˆ éƒ½åˆ ä¸æ‰çš„å¯ä»¥ç”¨æ–‡ä»¶ç²‰ç¢å·¥å…·æˆ–è€…è¿› PE é‡Œæš´åŠ›åˆ é™¤ã€‚**

![èµ„æºç›‘è§†å™¨](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/taskmgr_perfmon.png)

##### æ‰¹é‡åˆ é™¤ DLL

å¦‚æœé€šè¿‡èµ„æºç›‘è§†å™¨æ‰¾ä¸åˆ°è¿›ç¨‹ï¼Œé‚£é€šå¸¸æ˜¯è¢«èµ„æºç®¡ç†å™¨å ç”¨ç€ï¼ˆ è¿˜å¯èƒ½æ˜¯ **regsvr32** è¿›ç¨‹ ï¼‰ï¼Œæ‰¹å¤„ç†ç®€å•æŸ¥è¯¢ï¼ˆ **ç®¡ç†å‘˜æƒé™** ï¼‰ï¼š

```powershell
:: æŸ¥è¯¢å ç”¨æŒ‡å®š DLL çš„è¿›ç¨‹
tasklist /m xxxShellExt.dll

:: æŸ¥è¯¢æŒ‡å®šè¿›ç¨‹å ç”¨çš„æ‰€æœ‰ DLL
tasklist /m /fi "IMAGENAME eq explorer.exe" | findstr /i shell
```

![tasklist æŸ¥è¯¢ DLL å ç”¨](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/tasklist.png)

å¸è½½ **DLL** æˆ–è€…é‡å‘½åéƒ½å¯ä»¥ä½¿æ³¨å†Œè¡¨é…ç½®å¤±æ•ˆï¼Œå†é‡å¯èµ„æºç®¡ç†å™¨å°±å¯ä»¥è§£é™¤å ç”¨äº†ã€‚åœ¨æ¡Œé¢æ–°å»ºä¸€ä¸ªæ‰¹å¤„ç†æ–‡ä»¶ **æ‰¹é‡åˆ é™¤ DLL.bat** ï¼Œéšä¾¿æ‹–æ‹½éœ€è¦åˆ é™¤çš„ **DLL** æ–‡ä»¶æ‰€åœ¨ç›®å½•ä¸‹çš„æ–‡ä»¶åˆ°è¿™ä¸ªæ‰¹å¤„ç†æ–‡ä»¶çš„å›¾æ ‡ä¸Šå³å¯å®‰å…¨åˆ é™¤å¯¹åº”ç›®å½•ä¸‹ï¼ˆ åŒ…æ‹¬å­ç›®å½• ï¼‰æ‰€æœ‰çš„ **DLL** æ–‡ä»¶ï¼ˆ è§ä¸‹å›¾åŠ¨ç”» ï¼‰ã€‚

```powershell
:: ç®¡ç†å‘˜ææƒ
net session >nul 2>&1 || ( powershell -Command "Start-Process 'cmd' '/k \"\"%~f0\" \"%~1 \"\"' -Verb RunAs" & exit /b )
cd /d "%~dp1"
:: é¿å…åˆ é™¤ç³»ç»Ÿç›®å½•
if /i "%cd%" == "%windir%\System32" goto :eof
if /i "%cd%" == "%windir%\SysWOW64" goto :eof
taskkill /f /im regsvr32.exe
pause
:: å¸è½½ç›®å½•ä¸‹æ‰€æœ‰çš„ dll
for %%i in (*.dll) do regsvr32 /s /u "%%~fi"
:: ç»“æŸèµ„æºç®¡ç†å™¨ä»¥é‡Šæ”¾å ç”¨
taskkill /f /im explorer.exe
:: åˆ é™¤ç›®å½•ä¸‹æ‰€æœ‰çš„ dll
del /s /q *.dll
:: å¯åŠ¨èµ„æºç®¡ç†å™¨å¹¶å®šä½åˆ°ç›®å½•
start explorer & if exist %1 (explorer /select,%1) else explorer %cd%
:: é‡è¯•åˆ é™¤
del /s /q *.dll
```

![æ‰¹é‡åˆ é™¤ DLL](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/batch_delete_dll.gif)

ä¸ç”¨å‘½ä»¤ä¹Ÿæ˜¯å¯ä»¥çš„ï¼Œå…ˆç”¨ä»»åŠ¡ç®¡ç†å™¨æŠŠæ‰€æœ‰çš„ `explorer.exe` è¿›ç¨‹æ€æ‰ï¼Œå†æ‰§è¡Œï¼š

> ä»»åŠ¡ç®¡ç†å™¨å·¦ä¸Šè§’ > æ–‡ä»¶ > è¿è¡Œæ–°ä»»åŠ¡ > æµè§ˆ > ä¸‹æ‹‰æ¡†é€‰æ‹© **æ‰€æœ‰æ–‡ä»¶** > è¿›è¦åˆ é™¤çš„ç›®å½•ä¸€ä¸ªä¸€ä¸ªåˆ é™¤

![ä»»åŠ¡ç®¡ç†å™¨ > è¿è¡Œ > æµè§ˆ](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/taskmgr_run_browse.png)

å¦‚æœæç¤º **è¢«ä»»åŠ¡ç®¡ç†å™¨å ç”¨** å°±æŠŠä»»åŠ¡ç®¡ç†å™¨å…³äº†å†ç”¨å¿«æ·é”® `Ctrl + Shift + Esc` æ‰“å¼€ã€‚ç»“æŸ `explorer.exe` è¿›ç¨‹ä¼šå¯¼è‡´æ¡Œé¢å˜é»‘ï¼ˆ æ¡Œé¢å’Œä»»åŠ¡æ éƒ½è¢«å…³æ‰äº† ï¼‰ï¼Œé‡æ–°è¿è¡Œ `explorer.exe` å³å¯ã€‚

æ‰¾èµ„æ–™æ—¶çœ‹åˆ°äº† [AlwaysUnloadDll](https://techjourney.net/free-up-memory-automatically-by-unloading-dlls-in-windows-9x-and-nt-with-alwaysunloaddll) è¿™ä¸ªæ³¨å†Œè¡¨é…ç½®é¡¹ï¼Œä¼¼ä¹æ˜¯ä¸ºäº†ä½¿å¤è€ç³»ç»Ÿï¼ˆ **XP** ä¹‹å‰ ï¼‰åœ¨æ²¡æœ‰è¿›ç¨‹å¼•ç”¨ **DLL** åèƒ½å°½å¿«å°†å…¶ä»å†…å­˜ä¸­é‡Šæ”¾ï¼Œè¿™å¯¹äºæ–°ç³»ç»Ÿæ¥è¯´æ˜¯æ²¡ä½œç”¨çš„ã€‚ï¼ˆ [å‚è€ƒ](https://www.neowin.net/forum/topic/741324-xpalwaysunloaddll-does-improve-ram-utilization/?do=findComment&comment=590647236) ï¼‰

> [The Shell automatically unloads any DLL when its usage count is zero, but only after the DLL has not been used for a period of time.](<https://docs.microsoft.com/previous-versions/windows/desktop/legacy/cc144064(v=vs.85)#unloading-the-dll>)

#### é‡å¯ç”µè„‘

åˆ°æ­¤åŸºæœ¬ç®—æ˜¯æ¸…ç†å¹²å‡€äº†ï¼ˆ **SoftCnKiller** åº”è¯¥æ‰«ä¸å‡ºé—®é¢˜äº† ï¼‰ï¼Œé‡å¯ä¸€éç”µè„‘å†æ£€æŸ¥ä¸‹æ˜¯å¦è¿˜æœ‰æ®‹ç•™æ–‡ä»¶ã€‚å¯ä»¥å†ç”¨æ€æ¯’è½¯ä»¶æŸ¥æ€ä¸‹ï¼Œæœ‰äº›ç³»ç»Ÿé…ç½®ä¹Ÿå¯èƒ½ä¼šè¢«æ¶æ„ç¯¡æ”¹ï¼ˆ æ¯”å¦‚æµè§ˆå™¨ä¸»é¡µå’Œæœç´¢å¼•æ“ ï¼‰ã€‚

### å…³äºå¾®è½¯ç”µè„‘ç®¡å®¶

---

> [ã€å¾®è½¯ã€‘å¾®è½¯ç”µè„‘ç®¡å®¶ v.1.0 å†…æµ‹ï¼Œæ¬¢è¿å°ä¼—å°ä¼™ä¼´ä»¬åé¦ˆå’Œå»ºè®®](https://meta.appinn.net/t/topic/29410)

![å¾®è½¯ç”µè„‘ç®¡å®¶](https://cdn.jsdelivr.net/gh/anyesu/blog/docs/èŠèŠæµæ°“è½¯ä»¶/imgs/ms_pc_manager.png)

åˆ·æ–°é—»æ—¶çœ‹åˆ°è¿˜ä»¥ä¸ºçœ‹é”™äº†ï¼Œç»“æœæ˜¯çœŸçš„ï¼Œä¸‹è½½è¯•ç”¨åè¯´è¯´æˆ‘çš„æ§½ç‚¹ï¼š

- æ˜¯å¦å±±å¯¨

  è¿™ä¸ªè½¯ä»¶çš„ [å®˜ç½‘](https://bing.com/guanjia) æŒ‚åœ¨å¿…åº”çš„åŸŸåä¸‹é¢ï¼Œå®‰è£…åŒ…çš„æ•°å­—ç­¾åæ˜¯å¾®è½¯çš„ï¼Œå…¬ä¼—å·ä¹Ÿé€šè¿‡äº†å¾®è½¯ä¸­å›½çš„ä¼ä¸šè®¤è¯ï¼Œ [å¾®è½¯ç¤¾åŒº](https://answers.microsoft.com/zh-hans/windows/forum/all/å¾®è½¯ç”µè„‘ç®¡å®¶/4a460771-247c-4c3d-865b-5dfa401808ff) ä¹Ÿè¯å®äº†éš¶å±äºå¾®è½¯ä¸­å›½ã€‚ä¹Ÿæœ‰è¯´æ³•è¿™æ˜¯ä¸–çºªäº’è”å¼€å‘çš„ä¸­å›½ç‰¹ä¾›ç‰ˆï¼Œåæ­£å’Œå¾®è½¯ä¸­å›½å¤šå°‘æœ‰ç‚¹å…³ç³»ã€‚

  **æ—¢ç„¶æ‰“ç€å¾®è½¯çš„æ——å·è‚¯å®šæ˜¯å…è´¹æ— å¹¿å‘Šçš„ï¼Œé‚£ä»£ä»·ä¼°è®¡å°±æ˜¯é‡‡é›†ç”¨æˆ·æ•°æ®è¿›è¡Œåˆ†æäº†ã€‚**

- ä¸‹è½½äº†ç¦»çº¿å®‰è£…åŒ…ï¼Œç»“æœå®‰è£…çš„æ—¶å€™è¿˜è¦åœ¨çº¿ä¸‹è½½ **.Net5** ã€‚

  å¤´ä¸€å›è§åˆ°è¿™æ ·çš„ç¦»çº¿å®‰è£…åŒ…ã€‚

- å®‰è£…å®Œæ¯•ä¼šæœ‰ **QQ ç¾¤** äºŒç»´ç ï¼Œç†Ÿæ‚‰çš„å‘³é“ã€‚

- ç•Œé¢å’ŒåŠŸèƒ½æ€ä¹ˆçœ‹éƒ½åƒæ˜¯è…¾è®¯ç”µè„‘ç®¡å®¶çš„å¼Ÿå¼Ÿï¼Œè¿˜æ˜¯åˆšå‡ºç”Ÿçš„é‚£ç§ã€‚

  äº§å“è·¯çº¿å›¾å¦‚æœåªæ˜¯æƒ³ç…§ç€è…¾è®¯ç”µè„‘ç®¡å®¶æŠ„é‚£å°±å¤§å¯ä¸å¿…äº†ï¼Œåšå¤§äº†åè€Œåƒ **Edge** ä¸€æ ·ç³»ç»Ÿçº§æ†ç»‘ã€‚

ä»ç›®å‰ï¼ˆ 2022-04 ï¼‰æµ‹è¯•ç‰ˆå·²æœ‰çš„åŠŸèƒ½æ¥çœ‹ **ä¸æ¨è** ä½¿ç”¨ï¼Œé¸¡è‚‹è€Œä¸”è¿˜æœ‰é£é™©ã€‚è™½ç„¶å¸Œæœ›å®˜æ–¹ä¸‹åœºæ•´é¡¿ï¼Œä½†æ›´æ€•å®˜æ–¹å¸¦å¤´è€æµæ°“ï¼Œå¼ºåˆ¶è‡ªåŠ¨æ›´æ–°å’ŒåŠå¤œå¼€æœºé—¹é¬¼å°±æ˜¯å‰è½¦ä¹‹é‰´ã€‚

å†è¯´äº†ï¼Œè¿™å¹´å¤´æ­£å¸¸ä½¿ç”¨å‡ ä¹æ²¡æœ‰æ€æ¯’çš„éœ€æ±‚ï¼ˆ æƒ³æƒ³è‡ªå·±æœ‰ä»€ä¹ˆå€¼å¾—è¢«é»‘çš„ ï¼‰ï¼ŒçœŸä¸­æ¯’äº†è£…ä»€ä¹ˆéƒ½ä¸ç®¡ç”¨ã€‚æ‰€è°“ä¸€é”®ä¼˜åŒ–ã€å¿«é€ŸæŸ¥æ€åªæ˜¯ä¸ºäº†è¿åˆå¼ºè¿«ç—‡æ‚£è€…è€Œå·²ã€‚æˆ‘ä¸ªäººä½¿ç”¨è…¾è®¯ç”µè„‘ç®¡å®¶ä¹Ÿçº¯ç²¹åªæ˜¯å› ä¸ºè‡ªå¸¦çš„ **Windows Defender** ä¸¥æ ¼è¿‡å¤´äº†ã€‚

### å…¶ä»–èµ„æ–™

---

- [ä¸€ç§åˆ©ç”¨è¯ä¹¦è§„åˆ™ç¦ç”¨æµæ°“è½¯ä»¶çš„æ–¹æ³•](https://www.zhihu.com/question/35135573/answer/96955614)

---

### ç»“è¯­

---

ç»è¿‡åå¤æµ‹è¯•å‘ç°è¿™äº›æµæ°“è½¯ä»¶å„è‡ªéƒ½è¿˜ç®—æœ¬åˆ†ï¼Œå°±ç®—å·å·å®‰è£…ä¹Ÿæ˜¯å®‰è£…è‡ªå·±å®¶æ—çš„å…„å¼Ÿï¼Œå¹¿å‘Šä¹Ÿå°±æœ‰æ•°å‡ ä¸ªï¼Œåªæœ‰æµæ°“è½¯ä»¶æ•°é‡å¤šäº†æ‰èƒ½å½¢æˆç½‘ä¸Šé‚£ç§ [å…»è›Š](https://search.bilibili.com/all?keyword=æµæ°“è½¯ä»¶) çš„è´¨å˜æ•ˆæœï¼Œè€Œ **P2P ä¸‹å´½å™¨** æ‰æ˜¯ **ä¸‡æ¶ä¹‹æº** ï¼Œé™¤æ­¤ä¹‹å¤–æˆ‘ç›®å‰ ~~è¿˜æ²¡æ‰¾åˆ°~~ ï¼ˆ æ²¡æœºä¼š ï¼‰å…¶å®ƒè½¯ä»¶æœ‰è¿™ä¸ªæ•ˆæœçš„ã€‚

**æ‰€ä»¥ï¼Œå¹³æ—¶å¥½å¥½æ³¨æ„ä¸Šç½‘ä¹ æƒ¯ä¸€èˆ¬æ˜¯æ²¡é—®é¢˜çš„ï¼Œå°±ç®—ä¸­æ‹›äº†ï¼Œç…§ç€æœ¬æ–‡ç»™çš„æ­¥éª¤ä¹Ÿèƒ½è½»æ¾å¤„ç†ã€‚**

ç«™åœ¨è½¯ä»¶å¼€å‘çš„è§’åº¦ä¸Šï¼Œæµæ°“è½¯ä»¶çš„å¼€æœºå¯åŠ¨ã€å®šæ—¶ä»»åŠ¡ã€ä¿æ´»æœºåˆ¶ã€å³é”®èœå•ã€è‡ªåŠ¨æ¢å¤ç­‰ç­‰è¿˜æ˜¯å€¼å¾—å­¦ä¹ çš„ï¼Œç”¨åœ¨ **æ­£é€”** ä¸Šè¿˜æ˜¯èƒ½æé«˜ç”µè„‘çš„ä½¿ç”¨æ•ˆç‡ã€‚

å†™è¿™ç¯‡æ–‡ç« æœ¬æ¥åªæ˜¯æƒ³åšä¸ªç¬”è®°è€Œå·²ï¼Œç»“æœè·‘åå­¦ [æ³¨å†Œè¡¨](https://docs.microsoft.com/windows/win32/sysinfo/registry) å»äº†ï¼Œå¯¹ä¸€ä¸ªä¸ªè·¯å¾„çš„ä½œç”¨æœ‰äº†è¿›ä¸€æ­¥äº†è§£ã€‚å¦å¤–åˆå­¦ä¹ äº†è®¸å¤šæ‰¹å¤„ç†è„šæœ¬çš„ç‰¹æ®ŠæŠ€å·§ï¼ˆ [æ‰¹å¤„ç†ä¹‹å®¶](http://www.bathome.net) ï¼‰ï¼Œåœ¨è®°äº‹æœ¬é‡Œé¢å†™æ‰¹å¤„ç†ä¹Ÿç®—æ˜¯æ‰‹æ’¸ä»£ç äº†ï¼Œå†™çš„æ—¶å€™å¾ˆç—›è‹¦ï¼Œä½†å†™æˆåŠŸä¹‹åè¿˜æ˜¯å¾ˆä¸Šç˜¾çš„ ğŸ˜‚ ã€‚

---

#### è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼š [https://github.com/anyesu/blog/issues/42](https://anyesu.github.io/blog/articles/42)
